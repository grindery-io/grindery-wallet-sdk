{"version":3,"file":"grindery-wallet-sdk.umd.production.min.js","sources":["../src/classes/EventEmitter.ts","../src/classes/SdkStorage.ts","../src/utils/uuid.ts","../src/utils/providerInfo.ts","../src/classes/ProviderError.ts","../src/utils/chains.ts","../src/classes/Rpc.ts","../src/classes/Provider.ts","../src/utils/clientEvents.ts","../src/classes/WalletAPI.ts","../src/index.ts","../src/classes/WalletSDK.ts","../src/utils/getConfigFromDataAttributes.ts"],"sourcesContent":["/**\n * @summary Provider events\n * @since 0.2.0\n * @link https://eips.ethereum.org/EIPS/eip-1193#provider-events\n * @enum {string}\n */\nexport enum ProviderEvents {\n  accountsChanged = 'accountsChanged',\n  pair = 'pair',\n  connect = 'connect',\n  disconnect = 'disconnect',\n  chainChanged = 'chainChanged',\n  message = 'message',\n}\n\n/**\n * @summary Provider event name\n * @since 0.2.0\n */\nexport type ProviderEventName = keyof typeof ProviderEvents;\n\n/**\n * @summary A class for emitting provider events\n * @since 0.2.0\n */\nexport class EventEmitter {\n  constructor() {\n    this.events = new Map();\n  }\n\n  /**\n   * @summary A map of events and their listeners\n   * @private\n   */\n  private events: Map<ProviderEventName, Array<Function>>;\n\n  /**\n   * @summary Adds a listener to the event\n   * @public\n   * @param {string} event Event name\n   * @param {Function} callback Callback function\n   * @returns {EventEmitter} The instance of the class itself\n   */\n  public on(event: ProviderEventName, callback: Function) {\n    if (!this.events.has(event)) {\n      this.events.set(event, []);\n    }\n    this.events.get(event)!.push(callback);\n    return this;\n  }\n\n  /**\n   * @summary Removes a listener from the event\n   * @public\n   * @param {string} event Event name\n   * @param {Function} callback Callback function\n   * @returns {EventEmitter} The instance of the class itself\n   */\n  public removeListener(event: ProviderEventName, callback: Function) {\n    if (this.events.has(event)) {\n      const callbacks = this.events.get(event)!.filter((cb) => cb !== callback);\n      this.events.set(event, callbacks);\n    }\n    return this;\n  }\n\n  /**\n   * @summary Emits an event\n   * @public\n   * @param {string} event Event name\n   * @param data Event data\n   * @returns {EventEmitter} The instance of the class itself\n   */\n  protected emit(event: ProviderEventName, ...data: any[]) {\n    if (this.events.has(event)) {\n      console.log('[Grindery.WalletSDK] > Event:', event, data[0]);\n      this.events.get(event)!.forEach((callback) => {\n        callback(...data);\n      });\n    }\n    return this;\n  }\n}\n","import { CHAINS } from '../utils/chains';\nimport { uuid } from '../utils/uuid';\n\nconst LOCALSTORAGE_KEY = 'GrinderyWalletProvider';\n\n/**\n * @summary SdkStorage keys\n * @since 0.2.0\n */\nexport enum SdkStorageKeys {\n  pairingToken = 'pairingToken',\n  sessionId = 'sessionId',\n  connectUrl = 'connectUrl',\n  connectUrlBrowser = 'connectUrlBrowser',\n  shortToken = 'shortToken',\n  clientId = 'clientId',\n  address = 'address',\n  chainId = 'chainId',\n}\n\n/**\n * @summary SdkStorage key type\n * @since 0.2.0\n */\nexport type SdkStorageKey = keyof typeof SdkStorageKeys;\n\nexport type SdkStorageSnapshot = {\n  [key in SdkStorageKeys]?: string;\n};\n\n/**\n * @summary A class to handle local storage\n * @since 0.2.0\n */\nexport class SdkStorage {\n  /**\n   * @summary Gets the value of the storage by the key\n   * @public\n   * @param {SdkStorageKey} key Provider storage key\n   * @returns {string} The value of the storage by the key\n   */\n  public getValue(key: SdkStorageKey): string {\n    const value = this.getSnapshot()[key] || '';\n    return value;\n  }\n\n  /**\n   * @summary Sets the value of the storage by the key\n   * @public\n   * @param {SdkStorageKey} key Provider storage key\n   * @param {string} value The value to set\n   * @returns {void}\n   */\n  public setValue(key: SdkStorageKey, value: string): string {\n    const snapshot = this.getSnapshot();\n    snapshot[key] = value;\n    this.saveSnapshot(snapshot);\n    return value;\n  }\n\n  /**\n   * @summary Clears the storage\n   * @public\n   * @returns {void}\n   */\n  public clear(): void {\n    this.saveSnapshot({\n      clientId: this.getSnapshot().clientId || uuid(),\n      chainId: this.getSnapshot().chainId || CHAINS[0],\n    });\n  }\n\n  /**\n   * @summary Gets the storage\n   * @since 0.2.0\n   * @returns {SdkStorageSnapshot} The storage snapshot object\n   */\n  private getSnapshot(): SdkStorageSnapshot {\n    try {\n      return JSON.parse(\n        localStorage.getItem(LOCALSTORAGE_KEY) || '{}'\n      ) as SdkStorageSnapshot;\n    } catch (error) {\n      localStorage.setItem(LOCALSTORAGE_KEY, JSON.stringify({}));\n      throw new Error('Error parsing storage');\n    }\n  }\n\n  /**\n   * @summary Saves the storage\n   * @since 0.2.0\n   * @param {SdkStorageSnapshot} storage SdkStorage snapshot object\n   */\n  private saveSnapshot(storage: SdkStorageSnapshot): void {\n    localStorage.setItem(LOCALSTORAGE_KEY, JSON.stringify(storage));\n  }\n}\n","/**\n * @summary Generates a Version 4 (pseudorandom) UUID\n * @returns {string} The UUID\n */\nexport const uuid = (): string => {\n  let d = '';\n  while (d.length < 32) d += Math.random().toString(16).substr(2);\n  const vr = ((parseInt(d.substr(16, 1), 16) & 0x3) | 0x8).toString(16);\n  return `${d.substr(0, 8)}-${d.substr(8, 4)}-4${d.substr(\n    13,\n    3\n  )}-${vr}${d.substr(17, 3)}-${d.substr(20, 12)}`;\n};\n","import { uuid } from './uuid';\n\n/**\n * Represents the assets needed to display a wallet\n *\n * @since 0.1.1\n * @link https://eips.ethereum.org/EIPS/eip-6963#provider-info\n */\nexport interface EIP6963ProviderInfo {\n  uuid: string;\n  name: string;\n\n  /**\n   * Data URI as defined in RFC-2397.\n   *\n   * The image SHOULD be a square with 96x96px minimum resolution.\n   * The image format is RECOMMENDED to be either lossless or vector based such as PNG, WebP or SVG.\n   * @link https://eips.ethereum.org/EIPS/eip-6963#imagesicons\n   */\n  icon: string;\n\n  /**\n   * MUST BE a valid RFC-1034 Domain Name\n   * @link https://eips.ethereum.org/EIPS/eip-6963#rdns\n   */\n  rdns: string;\n}\n\nexport const providerInfo: EIP6963ProviderInfo = {\n  uuid: uuid(),\n  name: 'Grindery Wallet',\n  rdns: 'com.grindery.wallet',\n  icon: 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iOTYiIGhlaWdodD0iOTYiIHZpZXdCb3g9IjAgMCA5NiA5NiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9Ijk2IiBoZWlnaHQ9Ijk2IiByeD0iNDgiIGZpbGw9IiMwQjBEMTciLz4KPHBhdGggZD0iTTUyLjcwOTMgNTQuNjI5NUw0My40MDAzIDYwLjU2MTdDNDEuOTkwMiA2MS40NjAzIDQxLjU4OTQgNjMuMzEwNSA0Mi41MDUxIDY0LjY5NDJDNDMuNDA5NyA2Ni4wNjExIDQ1LjI2MDYgNjYuNDYxNSA0Ni42NjQ4IDY1LjYwNDhMNTIuNDQ4MiA2MS43MjY5TDU3LjU1NjggNTguMjk1MUM1Ny42MzgyIDU4LjI0MTkgNTcuNzE5MyA1OC4xODk2IDU3LjgwMDMgNTguMTM4NEw1OC4wNTgxIDU3Ljk2NTVDNTguMjA1MyA1Ny44NjY4IDU4LjM1NzggNTcuNzgxMyA1OC41MTQxIDU3LjcwODlDNTguNjQwNiA1Ny42MzY5IDU4Ljc2NjYgNTcuNTY3MyA1OC44OTIxIDU3LjUwMDFDNjEuOTUwMSA1NS44NjQ0IDY1Ljc4MDQgNTYuOTcwOSA2Ny40NDczIDU5Ljk3MTdDNjguOTA3NSA2Mi42MDAzIDY4LjI0MDggNjUuODc3NiA2NS44NjQgNjcuNzU0NUM2Ni4yMzc2IDY2Ljg3NDggNjYuMTc2OCA2NS44MzUyIDY1LjYwNzkgNjQuOTc1NUM2NC43MDMzIDYzLjYwODYgNjIuODUyNCA2My4yMDgzIDYxLjQ0ODIgNjQuMDY1TDU1LjY2NDggNjcuOTQyOEw1MC41NTYyIDcxLjM3NDdDNTAuNTA3OSA3MS40MDU1IDUwLjQ1OTQgNzEuNDM1OCA1MC40MTA3IDcxLjQ2NTdMNTAuMDU1IDcxLjcwNDJDNDkuNzU1OCA3MS45MDQ5IDQ5LjQzNDkgNzIuMDUwNiA0OS4xMDQ3IDcyLjE0MzhDNDQuNjU3MyA3NC4wNTkyIDM5LjMyMzggNzIuNTg5NCAzNi41OTI0IDY4LjQ2MjFDMzMuNzUxNiA2NC4xNjk2IDM0LjczMTcgNTguNTIzNCAzOC42OTg2IDU1LjM3MzZDMzYuODE0IDU0LjY1NzkgMzUuMDI3NSA1My41OTk1IDMzLjQzNjEgNTIuMTkzNEMyNi40MzA0IDQ2LjAwMzYgMjUuODU3NyAzNS40MjA1IDMyLjE1NjkgMjguNTU1NEMzOC40NTYyIDIxLjY5MDQgNDkuMjQxOSAyMS4xNDMxIDU2LjI0NzYgMjcuMzMyOUM2My4yNTMzIDMzLjUyMjggNjMuODI2IDQ0LjEwNTkgNTcuNTI2NyA1MC45NzA5QzU2LjExNTIgNTIuNTA5MyA1NC40Nzg0IDUzLjczMDQgNTIuNzA5MyA1NC42Mjk1Wk01MS44MDcgNDYuMDUxNkM1NS40MjMgNDIuMDgyMyA1NS4wOTQzIDM1Ljk2MzEgNTEuMDcyNyAzMi4zODQxQzQ3LjA1MTEgMjguODA1MiA0MC44NTk1IDI5LjEyMTYgMzcuMjQzNSAzMy4wOTFDMzMuNjI3NCAzNy4wNjA0IDMzLjk1NjIgNDMuMTc5NSAzNy45Nzc4IDQ2Ljc1ODVDNDEuOTk5NCA1MC4zMzc1IDQ4LjE5MDkgNTAuMDIxIDUxLjgwNyA0Ni4wNTE2WiIgZmlsbD0id2hpdGUiLz4KPC9zdmc+Cg==',\n};\n","/**\n * @summary Error class for wallet Provider\n * @since 0.1.0\n * @extends Error\n */\nexport class ProviderError extends Error {\n  name: string = 'GrinderyWalletProviderError';\n  code?: number;\n  data?: unknown;\n\n  constructor(message: string, code?: number, data?: unknown) {\n    super(message);\n    this.code = code;\n    this.data = data;\n  }\n}\n\nexport const ProviderErrors = {\n  PairingFailed: new ProviderError('Pairing failed', 4900),\n  Disconnected: new ProviderError('Disconnected', 4900),\n  UnsupportedMethod: new ProviderError('Unsupported Method', 4200),\n  Unauthorized: new ProviderError('Unauthorized', 4100),\n  NoResult: new ProviderError('No result', 4900),\n  NoAppId: new ProviderError('App ID is required', 4900),\n  UserRejected: new ProviderError('User Rejected Request', 4001),\n  ChainDisconnected: new ProviderError('Chain Disconnected', 4901),\n};\n\nexport const newProviderError = (error?: unknown): ProviderError => {\n  let errorResponse: ProviderError;\n  if (error instanceof ProviderError) {\n    errorResponse = new ProviderError(\n      error.message || 'Unknown error',\n      error.code || 4900,\n      error.data\n    );\n  } else if (error instanceof Error) {\n    errorResponse = new ProviderError(\n      error.message || 'Unknown error',\n      4900,\n      error\n    );\n  } else {\n    errorResponse = new ProviderError('Unknown error', 4900, error);\n  }\n  return errorResponse;\n};\n","/**\n * Supported chains list\n *\n * @description Currently supports the following chains: Polygon, BNB Smart Chain, and opBNB Smart Chain\n *\n * @since 0.3.0\n * @type {string[]} Chain ids in CAIP-2 format\n */\nexport const CHAINS: string[] = ['eip155:137', 'eip155:56', 'eip155:204'];\n\nexport const hexChainId = (chainId: string): string => {\n  return `0x${parseInt(chainId.split(':')[1], 10).toString(16)}`;\n};\n\nexport const unhexChainId = (hexChainId: string): string => {\n  return `eip155:${parseInt(hexChainId, 16)}`;\n};\n","import { ProviderError, ProviderErrors } from './ProviderError';\nimport { SdkStorage, SdkStorageKeys } from './SdkStorage';\nimport { WalletSDKConfig } from './WalletSDK';\n\n/**\n * @summary The Grindery RPC API method names\n */\nexport enum RpcMethodNames {\n  requestPairing = 'requestPairing',\n  waitForPairingResult = 'waitForPairingResult',\n  request = 'request',\n  waitForRequestResult = 'waitForRequestResult',\n  'disconnect' = 'disconnect',\n  getUserWalletAddress = 'getUserWalletAddress',\n  trackClientEvent = 'trackClientEvent',\n}\n\n/**\n * @summary The Grindery RPC API request results\n * @since 0.2.0\n */\nexport namespace RpcRequestResults {\n  /**\n   * @summary `waitForPairingResult` method result\n   */\n  export type waitForPairingResult = {\n    session: {\n      expiry: number;\n      sessionId: string;\n      namespaces: {\n        [key: string]: {\n          accounts: string[];\n          chains: string[];\n          events: string[];\n          methods: string[];\n        };\n      };\n    };\n  };\n\n  /**\n   * @summary `requestPairing` method result\n   */\n  export type requestPairing = {\n    config?: WalletSDKConfig;\n    pairingToken: string;\n    connectUrl: string;\n    connectUrlBrowser: string;\n    shortToken: string;\n    miniAppPairingToken?: string;\n  };\n\n  /**\n   * @summary `request` method result\n   */\n  export type request = {\n    requestToken: string;\n  };\n\n  /**\n   * @summary `waitForRequestResult` method result\n   */\n  export type waitForRequestResult = any;\n\n  /**\n   * @summary `disconnect` method result\n   */\n  export type disconnect = boolean;\n\n  /**\n   * @summary `getUserWalletAddress` method result\n   */\n  export type getUserWalletAddress = string;\n\n  /**\n   * @summary `trackClientEvent` method result\n   */\n  export type trackClientEvent = true;\n}\n\n/**\n * @summary The Grindery RPC API wrapper class\n * @since 0.2.0\n */\nexport class Rpc {\n  private config: WalletSDKConfig;\n\n  constructor(config: WalletSDKConfig) {\n    this.config = config;\n  }\n\n  /**\n   * @summary Sends a provider request to the Grindery RPC API and waits for the result.\n   * @public\n   * @param {RpcMethodNames} method Provider request method name\n   * @param {Array} params Provider request parameters\n   * @param {number} timeout Optional. The time in milliseconds to wait for the request result. Default is 30000.\n   * @returns The result of the provider request\n   */\n  public async sendAndWaitRpcRequest<T>(\n    method: string,\n    params?: readonly unknown[],\n    timeout?: number\n  ): Promise<T> {\n    const request = await this.sendRpcRequest(method, params);\n    return await this.waitRpcRequest(request.requestToken, timeout);\n  }\n\n  /**\n   * @summary Sends a provider request to the Grindery RPC API.\n   * @protected\n   * @param {RpcMethodNames} method Provider request method name\n   * @param {Array} params Provider request parameters\n   * @returns {RpcRequestResults.request} Promise resolving with the request token to use in the `waitGrinderyRpcProviderRequest` method\n   */\n  protected async sendRpcRequest(\n    method: string,\n    params?: readonly unknown[]\n  ): Promise<RpcRequestResults.request> {\n    const storage = new SdkStorage();\n    return await this.sendRpcApiRequest<RpcRequestResults.request>(\n      RpcMethodNames.request,\n      {\n        sessionId: storage.getValue(SdkStorageKeys.sessionId),\n        scope: storage.getValue(SdkStorageKeys.chainId),\n        request: {\n          method,\n          params,\n        },\n      }\n    );\n  }\n\n  /**\n   * @summary Waits for the result of the provider request.\n   * @protected\n   * @param {string} requestToken A token to identify provider request. Recieved in the results of `sendGrinderyRpcProviderRequest` method.\n   * @param {number} timeout Optional. The time in milliseconds to wait for the request result. Default is 30000.\n   * @returns The result of the provider request\n   */\n  protected async waitRpcRequest<T>(\n    requestToken: string,\n    timeout?: number\n  ): Promise<T> {\n    return await this.sendRpcApiRequest<T>(\n      RpcMethodNames.waitForRequestResult,\n      {\n        requestToken,\n        timeout,\n      }\n    );\n  }\n\n  /**\n   * @summary Sends a request to the Grindery Walletconnect RPC API.\n   * @public\n   * @param {RpcMethodNames} method Request method name\n   * @param {RequestArgumentsParams} params Request parameters\n   * @returns {T} The result of the request\n   */\n  public async sendRpcApiRequest<T>(\n    method: RpcMethodNames,\n    params?: unknown[] | object\n  ): Promise<T> {\n    try {\n      const response = await fetch(\n        this.config.pairingApiUrl || 'https://walletconnect-api.grindery.com',\n        {\n          method: 'POST',\n          headers: {\n            'Content-Type': 'application/json',\n          },\n          body: JSON.stringify({\n            jsonrpc: '2.0',\n            id: 1,\n            method: `gws_${method}`,\n            params: params || [],\n          }),\n        }\n      );\n      const data = await response.json();\n      if (data.error) {\n        throw new ProviderError(data.error.message, data.error.code);\n      }\n      if (!data.result) {\n        throw ProviderErrors.NoResult;\n      }\n      return data.result;\n    } catch (error) {\n      if (error instanceof Error) {\n        throw new ProviderError(error.message, 500, error);\n      }\n      throw new ProviderError('Server error', 500, error);\n    }\n  }\n}\n","import { providerInfo } from '../utils/providerInfo';\nimport { EventEmitter, ProviderEvents } from './EventEmitter';\nimport { ProviderErrors, newProviderError } from './ProviderError';\nimport { Rpc, RpcMethodNames, RpcRequestResults } from './Rpc';\nimport { SdkStorage, SdkStorageKeys } from './SdkStorage';\nimport { CHAINS, hexChainId, unhexChainId } from '../utils/chains';\nimport { WalletSDKConfig } from './WalletSDK';\n\n/**\n * @summary The Grindery wallet provider methods\n * @since 0.2.0\n */\nexport type ProviderMethods = {\n  [name in ProviderMethodNames]: (\n    params?: ProviderRequestArgumentsParams\n  ) => Promise<unknown>;\n};\n\n/**\n * @summary The Grindery wallet provider method names\n * @since 0.2.0\n * @since 0.3.0 Added `eth_chainId`, `wallet_addEthereumChain` and `wallet_switchEthereumChain` methods\n */\nexport enum ProviderMethodNames {\n  eth_requestAccounts = 'eth_requestAccounts',\n  eth_accounts = 'eth_accounts',\n  personal_sign = 'personal_sign',\n  eth_sendTransaction = 'eth_sendTransaction',\n  gws_disconnect = 'gws_disconnect',\n  eth_chainId = 'eth_chainId',\n  wallet_addEthereumChain = 'wallet_addEthereumChain',\n  wallet_switchEthereumChain = 'wallet_switchEthereumChain',\n}\n\nexport namespace ProviderRequestResults {\n  export type eth_accounts = string[];\n  export type eth_requestAccounts = string[];\n  export type personal_sign = string;\n  export type eth_sendTransaction = string;\n  export type disconnect = boolean;\n  export type wallet_switchEthereumChain = null;\n  export type wallet_addEthereumChain = null;\n  export type eth_chainId = string;\n}\n\n/**\n * @summary The Grindery wallet provider method names\n * @since 0.2.0\n */\nexport type ProviderMethodName = keyof typeof ProviderMethodNames;\n\n/**\n * @summary The Grindery wallet provider request params\n * @since 0.2.0\n */\nexport type ProviderRequestArgumentsParams = readonly unknown[] | object;\n\n/**\n * @summary The Grindery wallet provider request arguments\n * @since 0.2.0\n */\nexport interface ProviderRequestArguments {\n  readonly method: ProviderMethodName;\n  readonly params?: ProviderRequestArgumentsParams;\n}\n\n/**\n * @summary The base wallet provider class\n * @since 0.2.0\n * @extends EventEmitter\n */\nexport class Provider extends EventEmitter {\n  public isGrinderyWallet: boolean = true;\n  private config: WalletSDKConfig;\n\n  constructor(config: WalletSDKConfig) {\n    super();\n    this.config = config;\n    this.rpc = new Rpc(this.config);\n    if (this.config.appId) {\n      this.injectProvider();\n      this.listenForRequestProviderEvents();\n      this.announceProvider();\n    }\n    window.addEventListener('load', () => {\n      if (this.config.appId) {\n        this.emit(ProviderEvents.connect, {\n          chainId: hexChainId(\n            this.storage.getValue(SdkStorageKeys.chainId) ||\n              this.config.chainId ||\n              CHAINS[0]\n          ),\n        });\n        this.restorePairing();\n        this.restoreSession();\n      }\n    });\n  }\n\n  /**\n   * @public\n   * @returns {boolean} True if the provider is connected to the server.\n   */\n  public isConnected(): boolean {\n    // Always true\n    return true;\n  }\n\n  /**\n   * @summary Sends a request to the provider\n   * @public\n   * @param {ProviderRequestArguments} args Request arguments\n   * @param {string} args.method The method name\n   * @param {ProviderRequestArgumentsParams} args.params The method parameters\n   * @returns {T} The result of the request\n   */\n  public async request<T>({\n    method,\n    params,\n  }: ProviderRequestArguments): Promise<T> {\n    return (await this.methods[method]?.(params)) as T;\n  }\n\n  /**\n   * @summary Sends a request to the provider (legacy)\n   * @public\n   * @param {ProviderRequestArguments} args Request arguments\n   * @param {string} args.method The method name\n   * @param {ProviderRequestArgumentsParams} args.params The method parameters\n   * @param {Function} callback The callback function\n   * @deprecated Use `request` method instead\n   * @since 0.5.4\n   * @returns {void} `void`\n   */\n  public sendAsync(\n    { method, params }: ProviderRequestArguments,\n    callback: Function\n  ): void {\n    this.methods[method]?.(params)\n      .then((res) => {\n        callback(null, res);\n      })\n      .catch((error) => {\n        callback(error);\n      });\n  }\n\n  private storage: SdkStorage = new SdkStorage();\n\n  private rpc: Rpc;\n\n  /**\n   * @summary Switches the chain\n   * @since 0.3.0\n   * @param {string} chainId Chain id in hex format\n   * @returns {null} `Null` on success\n   */\n  private switchChain = async ({ chainId }: any): Promise<null> => {\n    const chainCaip = unhexChainId(chainId);\n    if (!CHAINS.includes(chainCaip)) {\n      throw newProviderError(ProviderErrors.ChainDisconnected);\n    }\n    this.storage.setValue(SdkStorageKeys.chainId, chainCaip);\n    this.emit(ProviderEvents.chainChanged, { chainId });\n    return null;\n  };\n\n  /**\n   * @summary The list of supported provider methods.\n   * @private\n   */\n  private methods: Partial<ProviderMethods> = {\n    /**\n     * @summary The `eth_requestAccounts` provider method\n     */\n    [ProviderMethodNames.eth_requestAccounts]: async (\n      params?: ProviderRequestArgumentsParams\n    ): Promise<ProviderRequestResults.eth_requestAccounts> => {\n      if (!this.config.appId) {\n        throw newProviderError(ProviderErrors.NoAppId);\n      }\n      if (this.storage.getValue('sessionId')) {\n        try {\n          return await this.request<ProviderRequestResults.eth_accounts>({\n            method: ProviderMethodNames.eth_accounts,\n            params: [],\n          });\n        } catch (error) {\n          this.storage.setValue(SdkStorageKeys.sessionId, '');\n          // skip failed request and continue with pairing\n        }\n      }\n      if (this.storage.getValue('pairingToken')) {\n        try {\n          const pairResult =\n            await this.rpc.sendRpcApiRequest<RpcRequestResults.waitForPairingResult>(\n              RpcMethodNames.waitForPairingResult,\n              {\n                pairingToken: this.storage.getValue(\n                  SdkStorageKeys.pairingToken\n                ),\n              }\n            );\n\n          this.storage.clear();\n          this.storage.setValue(\n            SdkStorageKeys.sessionId,\n            pairResult.session.sessionId\n          );\n\n          if (!pairResult.session.sessionId) {\n            throw ProviderErrors.PairingFailed;\n          }\n\n          return await this.request<ProviderRequestResults.eth_accounts>({\n            method: ProviderMethodNames.eth_accounts,\n            params: params || [],\n          });\n        } catch (error) {\n          this.storage.clear();\n          // skip failed request and continue with pairing\n        }\n      }\n      try {\n        this.storage.clear();\n        const result =\n          await this.rpc.sendRpcApiRequest<RpcRequestResults.requestPairing>(\n            RpcMethodNames.requestPairing,\n            {\n              appId: this.config.appId || '',\n              clientId: this.storage.getValue(SdkStorageKeys.clientId),\n              redirectMode: this.config.redirectMode,\n              redirectUrl: this.config.appUrl,\n            }\n          );\n\n        if (!result.pairingToken || !result.connectUrl) {\n          throw ProviderErrors.PairingFailed;\n        }\n\n        this.storage.setValue(SdkStorageKeys.pairingToken, result.pairingToken);\n        this.storage.setValue(SdkStorageKeys.connectUrl, result.connectUrl);\n        this.storage.setValue(\n          SdkStorageKeys.connectUrlBrowser,\n          result.connectUrlBrowser\n        );\n        this.storage.setValue(SdkStorageKeys.shortToken, result.shortToken);\n        this.emit(ProviderEvents.pair, {\n          config: this.config,\n          shortToken: result.shortToken,\n          connectUrl: result.connectUrl,\n          connectUrlBrowser: result.connectUrlBrowser,\n          miniAppPairingToken: result.miniAppPairingToken,\n        });\n        const pairResult =\n          await this.rpc.sendRpcApiRequest<RpcRequestResults.waitForPairingResult>(\n            RpcMethodNames.waitForPairingResult,\n            {\n              pairingToken: result.pairingToken,\n            }\n          );\n\n        this.storage.setValue(\n          SdkStorageKeys.sessionId,\n          pairResult.session.sessionId\n        );\n\n        if (!pairResult.session.sessionId) {\n          throw ProviderErrors.PairingFailed;\n        }\n        this.storage.setValue(SdkStorageKeys.pairingToken, '');\n        this.storage.setValue(SdkStorageKeys.connectUrl, '');\n        this.storage.setValue(SdkStorageKeys.connectUrlBrowser, '');\n        this.storage.setValue(SdkStorageKeys.shortToken, '');\n\n        return await this.request({\n          method: ProviderMethodNames.eth_accounts,\n          params: params || [],\n        });\n      } catch (error) {\n        throw error;\n      }\n    },\n\n    /**\n     * @summary The `eth_accounts` provider method\n     */\n    [ProviderMethodNames.eth_accounts]: async (\n      params?: ProviderRequestArgumentsParams\n    ): Promise<ProviderRequestResults.eth_accounts> => {\n      try {\n        const result = (await this.rpc.sendAndWaitRpcRequest<string[]>(\n          ProviderMethodNames.eth_accounts,\n          params ? (Array.isArray(params) ? params : [params]) : []\n        )) as ProviderRequestResults.eth_accounts;\n        this.storage.setValue(SdkStorageKeys.address, result[0] || '');\n        this.emit(ProviderEvents.accountsChanged, result);\n        return result;\n      } catch (error) {\n        throw newProviderError(error);\n      }\n    },\n\n    /**\n     * @summary The `eth_sendTransaction` provider method\n     */\n    [ProviderMethodNames.eth_sendTransaction]: async (\n      params?: ProviderRequestArgumentsParams\n    ): Promise<ProviderRequestResults.eth_sendTransaction> => {\n      return (await this.rpc.sendAndWaitRpcRequest(\n        ProviderMethodNames.eth_sendTransaction,\n        params ? (Array.isArray(params) ? params : [params]) : []\n      )) as ProviderRequestResults.eth_sendTransaction;\n    },\n\n    /**\n     * @summary The `personal_sign` provider method\n     */\n    [ProviderMethodNames.personal_sign]: async (\n      params?: Partial<ProviderRequestArgumentsParams>\n    ): Promise<ProviderRequestResults.personal_sign> => {\n      return (await this.rpc.sendAndWaitRpcRequest(\n        ProviderMethodNames.personal_sign,\n        params ? (Array.isArray(params) ? params : [params]) : []\n      )) as ProviderRequestResults.personal_sign;\n    },\n\n    /**\n     * @summary The `gws_disconnect` provider method\n     */\n    [ProviderMethodNames.gws_disconnect]:\n      async (): Promise<ProviderRequestResults.disconnect> => {\n        try {\n          const result =\n            await this.rpc.sendRpcApiRequest<ProviderRequestResults.disconnect>(\n              RpcMethodNames.disconnect,\n              {\n                sessionToken: this.storage.getValue(SdkStorageKeys.sessionId),\n              }\n            );\n\n          this.emit(ProviderEvents.disconnect, ProviderErrors.Disconnected);\n\n          return result;\n        } catch (error) {\n          throw newProviderError(error);\n        }\n      },\n\n    /**\n     * @summary The `eth_chainId` provider method\n     * @since 0.3.0\n     */\n    [ProviderMethodNames.eth_chainId]: async (\n      _?: ProviderRequestArgumentsParams\n    ): Promise<ProviderRequestResults.eth_chainId> => {\n      return hexChainId(\n        this.storage.getValue(SdkStorageKeys.chainId) ||\n          this.config.chainId ||\n          CHAINS[0]\n      );\n    },\n\n    /**\n     * @summary The `wallet_addEthereumChain` provider method\n     * @since 0.3.0\n     */\n    [ProviderMethodNames.wallet_addEthereumChain]: async (\n      _?: ProviderRequestArgumentsParams\n    ): Promise<ProviderRequestResults.wallet_addEthereumChain> => {\n      throw newProviderError(ProviderErrors.UserRejected);\n    },\n\n    /**\n     * @summary The `wallet_switchEthereumChain` provider method\n     * @since 0.3.0\n     */\n    [ProviderMethodNames.wallet_switchEthereumChain]: async (\n      params?: ProviderRequestArgumentsParams\n    ): Promise<ProviderRequestResults.wallet_switchEthereumChain> =>\n      await this.switchChain(params),\n  };\n\n  /**\n   * @summary Restores the pairing process if pairing token is stored in the local storage\n   * @private\n   * @returns {void}\n   */\n  private async restorePairing(): Promise<void> {\n    const pairingToken = this.storage.getValue(SdkStorageKeys.pairingToken);\n    const sessionId = this.storage.getValue(SdkStorageKeys.sessionId);\n    if (pairingToken && !sessionId) {\n      try {\n        const pairResult =\n          await this.rpc.sendRpcApiRequest<RpcRequestResults.waitForPairingResult>(\n            RpcMethodNames.waitForPairingResult,\n            {\n              pairingToken,\n            }\n          );\n\n        this.storage.clear();\n        this.storage.setValue(\n          SdkStorageKeys.sessionId,\n          pairResult.session.sessionId\n        );\n\n        if (!pairResult.session.sessionId) {\n          throw ProviderErrors.PairingFailed;\n        }\n\n        const accounts = (\n          pairResult.session?.namespaces?.[`eip155`]?.accounts || []\n        ).map((account) =>\n          account.includes(':') ? account.split(':')[2] || '' : account\n        );\n        this.storage.setValue(SdkStorageKeys.address, accounts[0] || '');\n        this.emit(ProviderEvents.accountsChanged, accounts);\n      } catch (error) {\n        this.storage.clear();\n      }\n    }\n  }\n\n  /**\n   * @summary Restores the session if session Id is stored in the local storage\n   * @private\n   * @returns {void}\n   */\n  private async restoreSession(): Promise<void> {\n    const pairingToken = this.storage.getValue(SdkStorageKeys.pairingToken);\n    const sessionId = this.storage.getValue(SdkStorageKeys.sessionId);\n    if (sessionId && !pairingToken) {\n      try {\n        await this.request<string[]>({\n          method: ProviderMethodNames.eth_requestAccounts,\n        });\n      } catch (error) {\n        this.storage.clear();\n      }\n    }\n  }\n\n  /**\n   * @summary Injects the provider into the window object\n   * @private\n   * @returns {void}\n   */\n  private injectProvider(): void {\n    if (!window.ethereum) {\n      window.ethereum = this;\n    } else {\n      if (\n        window.ethereum.providers &&\n        Array.isArray(window.ethereum.providers)\n      ) {\n        if (\n          window.ethereum.providers.filter((p: any) => p.isGrinderyWallet)\n            .length > 0\n        ) {\n          window.ethereum.providers = window.ethereum.providers.map(\n            (p: any) => {\n              if (p.isGrinderyWallet) {\n                return this;\n              }\n              return p;\n            }\n          );\n        } else {\n          window.ethereum.providers.push(this);\n        }\n      } else {\n        window.ethereum.providers = [window.ethereum, this];\n      }\n    }\n  }\n\n  /**\n   * @summary Announces the provider to the window object\n   * @private\n   * @since 0.1.1\n   * @link https://eips.ethereum.org/EIPS/eip-6963#announce-and-request-events\n   * @returns {void}\n   */\n  private announceProvider(): void {\n    window.dispatchEvent(\n      new CustomEvent('eip6963:announceProvider', {\n        detail: Object.freeze({ info: providerInfo, provider: this }),\n      })\n    );\n  }\n\n  /**\n   * @summary Listens for the request provider events\n   * @private\n   * @since 0.1.1\n   * @link https://eips.ethereum.org/EIPS/eip-6963#announce-and-request-events\n   * @returns {void}\n   */\n  private listenForRequestProviderEvents(): void {\n    window.addEventListener('eip6963:requestProvider', () => {\n      this.announceProvider();\n    });\n  }\n}\n","export enum ClientEventNames {\n  /**\n   * @summary The event is triggered every time the app page is opened\n   */\n  appOpened = 'appOpened',\n  /**\n   * @summary The event is triggered when the user wallet is connected\n   */\n  walletConnected = 'walletConnected',\n  /**\n   * @summary The event is triggered when the user wallet is disconnected\n   */\n  walletDisconnected = 'walletDisconnected',\n  /**\n   * @summary The event is triggered when the app requests user wallet address\n   */\n  walletAddressRequested = 'walletAddressRequested',\n}\n\nexport type ClientEventName = keyof typeof ClientEventNames;\n","import { SdkStorage, SdkStorageKeys } from './SdkStorage';\n\n/**\n * @summary The Grindery Wallet API wrapper class\n * @since 0.5.0\n */\nexport class WalletAPI {\n  /**\n   * @summary Sends a request to the Grindery Wallet API\n   * @public\n   * @param {string} method JSON-RPC method name\n   * @param {object} params JSON-RPC method parameters, optional\n   * @returns {T} The result of the API request\n   */\n  public async sendApiRequest<T>(method: string, params?: object): Promise<T> {\n    const storage = new SdkStorage();\n    const sessionId = storage.getValue(SdkStorageKeys.sessionId);\n    const address = storage.getValue(SdkStorageKeys.address);\n    if (!sessionId || !address) {\n      throw new Error('Not connected to the wallet');\n    }\n    const response = await fetch(\n      window.Grindery?.WalletSDK?.config.walletApiUrl ||\n        'https://wallet-api.grindery.com/v3',\n      {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          Authorization: `Bearer ${address}:${sessionId}`,\n        },\n        body: JSON.stringify({\n          jsonrpc: '2.0',\n          id: 1,\n          method,\n          params: params || {},\n        }),\n      }\n    );\n\n    if (!response.ok) {\n      throw new Error(`Failed to call ${method}`);\n    }\n    const json = await response.json();\n    return json.result as T;\n  }\n}\n","import { WalletSDK } from './classes/WalletSDK';\n\ndeclare global {\n  interface Window {\n    Telegram?: any;\n    ethereum?: any;\n    Grindery?: {\n      appId?: string;\n      appUrl?: string;\n      redirectMode?: string;\n      pairingApiUrl?: string;\n      walletApiUrl?: string;\n      chainId?: string;\n      WalletSDK?: WalletSDK;\n    };\n  }\n}\n\n/**\n * @summary The Grindery Wallet SDK\n */\nexport const GrinderyWalletSDK = WalletSDK;\n\nfunction init() {\n  if (\n    !window.Grindery?.WalletSDK ||\n    !(window.Grindery.WalletSDK instanceof WalletSDK)\n  ) {\n    window.Grindery = {\n      ...(window.Grindery || {}),\n      WalletSDK: new WalletSDK(),\n    };\n  }\n}\n\n// Initialize the SDK\ninit();\n","import { ProviderEventName, ProviderEvents } from './EventEmitter';\nimport { Provider, ProviderMethodNames } from './Provider';\nimport { Rpc, RpcMethodNames, RpcRequestResults } from './Rpc';\nimport { SdkStorage, SdkStorageKeys } from './SdkStorage';\nimport { CHAINS, hexChainId } from '../utils/chains';\nimport { ClientEventName, ClientEventNames } from '../utils/clientEvents';\nimport { User } from '../utils/user';\nimport { WalletAPI } from './WalletAPI';\nimport { getConfigFromDataAttributes } from '../utils/getConfigFromDataAttributes';\n\nexport type WalletSDKConfig = {\n  /**\n   * @summary The application ID, obtained in the Grindery bot by the dApp developer.\n   */\n  appId: string;\n  /**\n   * @summary The application URL. If not provided, the current page URL will be used.\n   */\n  appUrl: string;\n  /**\n   * @summary The pairing API URL. If not provided, the default Grindery API URL will be used.\n   */\n  pairingApiUrl?: string;\n  /**\n   * @summary The wallet API URL. If not provided, the default Grindery API URL will be used.\n   */\n  walletApiUrl?: string;\n  /**\n   * @summary The redirect mode for the pairing request.\n   * @example 'tg' | 'url' | 'close'\n   */\n  redirectMode?: string;\n  /**\n   * @summary The default chain ID in CAIP-2 format.\n   */\n  chainId?: string;\n};\n\n/**\n * @summary The Wallet SDK class\n * @since 0.2.0\n */\nexport class WalletSDK {\n  /**\n   * @summary The provider instance\n   * @public\n   */\n  public provider: Provider;\n\n  public config: WalletSDKConfig = {\n    appId: window.Grindery?.appId || '',\n    appUrl: window.Grindery?.appUrl || window.location.origin,\n    redirectMode: window.Grindery?.redirectMode,\n    pairingApiUrl: window.Grindery?.pairingApiUrl,\n    walletApiUrl: window.Grindery?.walletApiUrl,\n    chainId: window.Grindery?.chainId,\n  };\n\n  constructor(config?: Partial<WalletSDKConfig>) {\n    this.config = {\n      ...this.config,\n      ...(config || getConfigFromDataAttributes() || {}),\n    };\n\n    window.Grindery = {\n      ...window.Grindery,\n      ...this.config,\n    };\n\n    this.storage.setValue(\n      SdkStorageKeys.chainId,\n      this.storage.getValue(SdkStorageKeys.chainId) ||\n        this.config.chainId ||\n        CHAINS[0]\n    );\n    this.detectPairingToken();\n    this.provider = this.getWeb3Provider();\n    this.initTracking();\n    if (this.config.appId) {\n      this.provider.on(ProviderEvents.pair, this.handlePairing);\n    }\n  }\n\n  /**\n   * @summary Checks if the provider is connected to the server\n   * @returns {boolean} True if the provider is connected to the server.\n   *\n   * @example\n   * ```typescript\n   * const isConnected = window.Grindery.WalletSDK.isConnected();\n   * ```\n   */\n  public isConnected(): boolean {\n    return this.provider.isConnected();\n  }\n\n  /**\n   * @summary Checks if the provider is connected to the server and the Grindery Wallet\n   * @returns {boolean} True if the provider is connected to the server and the Grindery Wallet.\n   */\n  public isWalletConnected(): boolean {\n    return (\n      this.isConnected() &&\n      !!this.storage.getValue(SdkStorageKeys.pairingToken) &&\n      !this.storage.getValue(SdkStorageKeys.sessionId)\n    );\n  }\n\n  /**\n   * @summary Initiate connection to the Grindery Wallet\n   * @public\n   * @returns {Promise<string[]>} The array of ethereum addresses\n   * @since 0.1.0\n   */\n  public async connect(): Promise<string[]> {\n    return await this.provider.request({\n      method: ProviderMethodNames.eth_requestAccounts,\n    });\n  }\n\n  /**\n   * @summary Disconnects Grindery Wallet\n   * @public\n   * @returns {Promise<boolean>} True if wallet is disconnected\n   * @since 0.1.0\n   */\n  public async disconnect(): Promise<boolean> {\n    return await this.provider.request({\n      method: ProviderMethodNames.gws_disconnect,\n    });\n  }\n\n  /**\n   * @summary Sends a transaction request to the Grindery Wallet\n   * @public\n   * @since 0.1.0\n   * @param {object} params The transaction parameters\n   * @param {string} params.to The recipient address\n   * @param {string} [params.value] The amount to send in wei\n   * @param {string} [params.data] The data to send\n   * @returns {Promise<string>} Transaction hash string\n   */\n  public async sendTransaction(params: {\n    to: string;\n    value?: string;\n    data?: string;\n  }): Promise<string> {\n    return await this.provider.request<string>({\n      method: ProviderMethodNames.eth_sendTransaction,\n      params: [params],\n    });\n  }\n\n  /**\n   * @summary Sends a personal signature request to the Grindery Wallet\n   * @public\n   * @since 0.1.0\n   * @param {string} message The message to sign\n   * @returns {Promise<string>} Signature string\n   */\n  public async signMessage(message: string): Promise<string> {\n    return await this.provider.request<string>({\n      method: ProviderMethodNames.personal_sign,\n      params: [message, this.storage.getValue('address')],\n    });\n  }\n\n  /**\n   * @summary Requests the Grindery Wallet to switch the chain\n   * @public\n   * @since 0.3.0\n   * @param {string} chainId Chain id in CAIP-2 format\n   * @returns {Promise<null>} Returns `null` on success\n   */\n  public async switchChain(chainId: string): Promise<null> {\n    return await this.provider.request<null>({\n      method: ProviderMethodNames.wallet_switchEthereumChain,\n      params: { chainId: hexChainId(chainId) },\n    });\n  }\n\n  /**\n   * @summary Gets currently connected chain\n   * @public\n   * @since 0.3.0\n   * @returns {string} Returns chain id in CAIP-2 format\n   */\n  public getChain(): string {\n    return (\n      this.storage.getValue(SdkStorageKeys.chainId) ||\n      this.config.chainId ||\n      CHAINS[0]\n    );\n  }\n\n  /**\n   * @summary Exchange Telegram user ID to Grindery Wallet address\n   * @public\n   * @since 0.4.0\n   * @param {string} userId Telegram user ID\n   * @returns {Promise<string>} Grindery Wallet address\n   */\n  public async getUserWalletAddress(\n    userId: string\n  ): Promise<RpcRequestResults.getUserWalletAddress> {\n    const rpc = new Rpc(this.config);\n    this.trackClientEvent(ClientEventNames.walletAddressRequested, { userId });\n    if (!this.config.appId) {\n      throw new Error('App ID is required');\n    }\n    return await rpc.sendRpcApiRequest<RpcRequestResults.getUserWalletAddress>(\n      RpcMethodNames.getUserWalletAddress,\n      { appId: this.config.appId, userId }\n    );\n  }\n\n  /**\n   * @summary Adds a listener to the event\n   * @public\n   * @param {ProviderEventName} event Event name\n   * @param {Function} callback Callback function\n   * @returns {EventEmitter} The instance of the class itself\n   */\n  public on(event: ProviderEventName, callback: Function) {\n    this.provider.on(event, callback);\n    return this;\n  }\n\n  /**\n   * @summary Removes a listener from the event\n   * @public\n   * @param {ProviderEventName} event Event name\n   * @param {Function} callback Callback function\n   * @returns {EventEmitter} The instance of the class itself\n   */\n  public removeListener(event: ProviderEventName, callback: Function) {\n    this.provider.removeListener(event, callback);\n    return this;\n  }\n\n  /**\n   * @summary Gets the Grindery user information\n   * @public\n   * @since 0.5.0\n   * @returns {Promise<User>} The Grindery user information\n   */\n  public async getUser(): Promise<User> {\n    if (!this.user) {\n      const api = new WalletAPI();\n      try {\n        this.user = await api.sendApiRequest<User>('gw_getMe');\n      } catch (e) {\n        throw new Error(\n          e instanceof Error ? e.message : 'Failed to fetch user information'\n        );\n      }\n    }\n    return this.user;\n  }\n\n  /**\n   * @summary Sets the application ID\n   * @public\n   * @since 0.5.1\n   * @param {string} appId The application ID\n   * @returns {void}\n   */\n  public setAppId(appId: string): void {\n    let appIdUpdated = false;\n    if (appId !== this.config.appId) {\n      appIdUpdated = true;\n    }\n    this.config.appId = appId;\n    window.Grindery = {\n      ...window.Grindery,\n      appId,\n    };\n    if (appIdUpdated) {\n      this.provider = this.getWeb3Provider();\n      this.initTracking();\n      this.provider.removeListener(ProviderEvents.pair, this.handlePairing);\n      setTimeout(() => {\n        this.provider.on(ProviderEvents.pair, this.handlePairing);\n      }, 0);\n    }\n  }\n\n  /**\n   * @summary Sets the SDK config\n   * @public\n   * @since 0.5.1\n   * @param {object} config The partial SDK config object\n   * @returns {void}\n   */\n  public setConfig(config: Partial<WalletSDKConfig>): void {\n    let appIdUpdated = false;\n    if (config.appId !== this.config.appId) {\n      appIdUpdated = true;\n    }\n    this.config = { ...this.config, ...config };\n    window.Grindery = {\n      ...window.Grindery,\n      ...this.config,\n    };\n    if (appIdUpdated) {\n      this.provider = this.getWeb3Provider();\n      this.initTracking();\n      this.provider.removeListener(ProviderEvents.pair, this.handlePairing);\n      setTimeout(() => {\n        this.provider.on(ProviderEvents.pair, this.handlePairing);\n      }, 0);\n    }\n  }\n\n  /**\n   * @summary SdkStorage class instance\n   * @private\n   */\n  private storage: SdkStorage = new SdkStorage();\n\n  /**\n   * @summary The Grindery Wallet user\n   * @private\n   */\n  private user: User | null = null;\n\n  /**\n   * @summary Gets the Grindery Wallet ethereum provider\n   * @returns {Provider} The Grindery Wallet ethereum provider\n   */\n  private getWeb3Provider(): Provider {\n    return new Provider(this.config);\n  }\n\n  /**\n   * @summary Handles the pairing request, by opening the Grindery Wallet\n   * @private\n   * @param ProviderRequestPairingResult\n   * @returns {void}\n   */\n  private handlePairing({\n    config,\n    shortToken,\n    connectUrl,\n    connectUrlBrowser,\n    miniAppPairingToken,\n  }: RpcRequestResults.requestPairing): void {\n    const WebApp = window.Telegram?.WebApp;\n    const redirectUrl =\n      connectUrlBrowser ||\n      `https://www.grindery.com/connect/wc?uri=${shortToken}`;\n    const miniAppUrl = miniAppPairingToken\n      ? `https://t.me/GrinderyConnectTestBot/confirm?startapp=${miniAppPairingToken.replaceAll(\n          '.',\n          '___'\n        )}`\n      : '';\n    if (miniAppUrl && config?.redirectMode === 'tg') {\n      try {\n        window.Telegram?.WebApp?.openTelegramLink?.(miniAppUrl);\n      } catch (e) {\n        window.open(miniAppUrl, '_blank');\n      }\n      return;\n    }\n    if (\n      WebApp &&\n      WebApp.openTelegramLink &&\n      WebApp.platform &&\n      WebApp.platform !== 'unknown' &&\n      connectUrl\n    ) {\n      WebApp.openTelegramLink(connectUrl);\n    } else {\n      window.open(redirectUrl, '_blank');\n    }\n  }\n\n  /**\n   * @summary Tracks client side event\n   * @since 0.4.2\n   * @private\n   * @param AppEvent\n   * @returns {Promise<void>}\n   */\n  private async trackClientEvent(\n    name: ClientEventName,\n    data?: Record<string, unknown>\n  ): Promise<void> {\n    const appUrl = this.config.appUrl;\n    const appId = this.config.appId;\n    const userTelegramId = String(\n      window.Telegram?.WebApp?.initDataUnsafe?.user?.id || ''\n    );\n\n    try {\n      if (!appId) {\n        throw new Error('App ID is required');\n      }\n      if (!userTelegramId) {\n        throw new Error('User Telegram ID is required');\n      }\n      const rpc = new Rpc(this.config);\n      await rpc.sendRpcApiRequest<RpcRequestResults.trackClientEvent>(\n        RpcMethodNames.trackClientEvent,\n        {\n          name,\n          appUrl,\n          userTelegramId,\n          data: {\n            ...(data || {}),\n            pageUrl: window.location.href,\n            appId,\n            sessionId: this.storage.getValue(SdkStorageKeys.sessionId),\n            clientId: this.storage.getValue(SdkStorageKeys.clientId),\n            isMiniApp: Boolean(window.Telegram?.initDataUnsafe),\n            miniAppPlatform: window.Telegram?.WebApp?.platform,\n            miniAppSdkVersion: window.Telegram?.WebApp?.version,\n            userAgent: window.navigator.userAgent,\n          },\n        }\n      );\n    } catch (e) {\n      // ignore\n    }\n  }\n\n  /**\n   * @summary Initializes the tracking\n   * @since 0.4.2\n   * @private\n   * @returns {void}\n   */\n  private initTracking(): void {\n    const onWalletConnect = (wallets: string[]) => {\n      if (wallets.length > 0) {\n        this.trackClientEvent(ClientEventNames.walletConnected, {\n          wallets: wallets,\n        });\n      }\n    };\n\n    const onWalletDisconnect = () => {\n      this.trackClientEvent(ClientEventNames.walletDisconnected);\n    };\n\n    this.on(ProviderEvents.accountsChanged, onWalletConnect);\n    this.on(ProviderEvents.disconnect, onWalletDisconnect);\n  }\n\n  private detectPairingToken(): void {\n    const urlParams = new URLSearchParams(window.location.search);\n    const token =\n      urlParams.get('_grinderyPairingToken') ||\n      urlParams.get('tgWebAppStartParam');\n    if (token) {\n      this.storage.setValue(SdkStorageKeys.pairingToken, token);\n    }\n  }\n}\n","import { WalletSDKConfig } from '../classes/WalletSDK';\n\n/**\n * @summary Get the SDK config from the script tag data attributes\n * @returns {object} The SDK config object\n */\nexport const getConfigFromDataAttributes = (): Partial<WalletSDKConfig> => {\n  let config: Partial<WalletSDKConfig> = {};\n  const attributesMap = {\n    'data-app-id': 'appId',\n    'data-wallet-api-url': 'walletApiUrl',\n    'data-pairing-api-url': 'pairingApiUrl',\n    'data-app-url': 'appUrl',\n    'data-redirect-mode': 'redirectMode',\n    'data-chain-id': 'chainId',\n  };\n  for (const [attribute, key] of Object.entries(attributesMap)) {\n    const elements = document.querySelectorAll(`[${attribute}]`);\n    for (let j = 0; j < elements.length; j++) {\n      const element = elements[j];\n      const value = element.getAttribute(attribute);\n      const src = element.getAttribute('src');\n      const isGrinderySrc = src && src.includes('grindery-wallet-sdk');\n      if (isGrinderySrc && value) {\n        config[key as keyof WalletSDKConfig] = value as string;\n      }\n    }\n  }\n  return config;\n};\n"],"names":["ProviderEvents","SdkStorageKeys","EventEmitter","this","events","Map","_proto","prototype","on","event","callback","has","set","get","push","removeListener","callbacks","filter","cb","emit","_len","arguments","length","data","Array","_key","console","log","forEach","apply","uuid","d","Math","random","toString","substr","vr","parseInt","providerInfo","name","rdns","icon","ProviderError","_Error","message","code","_this","call","_inheritsLoose","_wrapNativeSuper","Error","ProviderErrors","PairingFailed","Disconnected","UnsupportedMethod","Unauthorized","NoResult","NoAppId","UserRejected","ChainDisconnected","newProviderError","error","CHAINS","hexChainId","chainId","split","unhexChainId","LOCALSTORAGE_KEY","RpcMethodNames","SdkStorage","getValue","key","getSnapshot","setValue","value","snapshot","saveSnapshot","clear","clientId","JSON","parse","localStorage","getItem","setItem","stringify","storage","ProviderMethodNames","Rpc","config","sendAndWaitRpcRequest","_sendAndWaitRpcRequest","_asyncToGenerator","_regeneratorRuntime","mark","_callee","method","params","timeout","request","wrap","_context","prev","next","sendRpcRequest","sent","waitRpcRequest","requestToken","abrupt","stop","_x","_x2","_x3","_sendRpcRequest","_callee2","_context2","sendRpcApiRequest","sessionId","scope","_x4","_x5","_waitRpcRequest","_callee3","_context3","waitForRequestResult","_x6","_x7","_sendRpcApiRequest","_callee4","response","_context4","fetch","pairingApiUrl","headers","body","jsonrpc","id","json","result","t0","_x8","_x9","Provider","ClientEventNames","_EventEmitter","_this$methods","_ref10","_ref9","_ref8","_ref6","_ref5","_ref4","_ref3","isGrinderyWallet","rpc","switchChain","_ref2","_ref","chainCaip","includes","chainChanged","methods","eth_requestAccounts","pairResult","_pairResult","appId","eth_accounts","waitForPairingResult","pairingToken","session","t1","requestPairing","redirectMode","redirectUrl","appUrl","connectUrl","connectUrlBrowser","shortToken","pair","miniAppPairingToken","t2","isArray","address","accountsChanged","eth_sendTransaction","personal_sign","_callee5","_context5","gws_disconnect","_callee6","_context6","disconnect","sessionToken","eth_chainId","_callee7","_","_context7","wallet_addEthereumChain","_callee8","_context8","wallet_switchEthereumChain","_callee9","_context9","injectProvider","listenForRequestProviderEvents","announceProvider","window","addEventListener","connect","restorePairing","restoreSession","isConnected","_request","_callee10","_ref11","_this$methods$method","_this$methods2","_context10","sendAsync","_ref12","_this$methods$method2","_this$methods3","then","res","_restorePairing","_callee11","_pairResult$session","accounts","_context11","namespaces","map","account","_restoreSession","_callee12","_context12","_this2","ethereum","providers","p","dispatchEvent","CustomEvent","detail","Object","freeze","info","provider","_this3","_window$Grindery","WalletAPI","sendApiRequest","_sendApiRequest","Grindery","WalletSDK","walletApiUrl","Authorization","ok","_window$Grindery2","_window$Grindery3","_window$Grindery4","_window$Grindery5","_window$Grindery6","location","origin","user","_extends","_i","_Object$entries","entries","_Object$entries$_i","attribute","elements","document","querySelectorAll","j","element","getAttribute","src","getConfigFromDataAttributes","detectPairingToken","getWeb3Provider","initTracking","handlePairing","isWalletConnected","_connect","_disconnect","sendTransaction","_sendTransaction","signMessage","_signMessage","_switchChain","getChain","getUserWalletAddress","_getUserWalletAddress","userId","trackClientEvent","walletAddressRequested","getUser","_getUser","api","setAppId","appIdUpdated","setTimeout","setConfig","_window$Telegram","WebApp","Telegram","miniAppUrl","replaceAll","_window$Telegram2","openTelegramLink","e","open","platform","_trackClientEvent","_window$Telegram3","userTelegramId","_window$Telegram4","_window$Telegram5","_window$Telegram6","String","initDataUnsafe","pageUrl","href","isMiniApp","Boolean","miniAppPlatform","miniAppSdkVersion","version","userAgent","navigator","wallets","walletConnected","walletDisconnected","urlParams","URLSearchParams","search","token","GrinderyWalletSDK"],"mappings":"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"}