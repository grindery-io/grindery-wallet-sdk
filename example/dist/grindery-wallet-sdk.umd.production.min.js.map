{"version":3,"file":"grindery-wallet-sdk.umd.production.min.js","sources":["../src/classes/EventEmitter.ts","../src/classes/SdkStorage.ts","../src/utils/uuid.ts","../src/utils/providerInfo.ts","../src/classes/ProviderError.ts","../src/utils/chains.ts","../src/classes/Rpc.ts","../src/classes/Provider.ts","../src/index.ts","../src/classes/WalletAPI.ts","../src/classes/WalletSDK.ts","../src/utils/getConfigFromDataAttributes.ts"],"sourcesContent":["/**\n * @summary Provider events\n * @since 0.2.0\n * @link https://eips.ethereum.org/EIPS/eip-1193#provider-events\n * @enum {string}\n */\nexport enum ProviderEvents {\n  accountsChanged = 'accountsChanged',\n  pair = 'pair',\n  connect = 'connect',\n  disconnect = 'disconnect',\n  chainChanged = 'chainChanged',\n  message = 'message',\n}\n\n/**\n * @summary Provider event name\n * @since 0.2.0\n */\nexport type ProviderEventName = keyof typeof ProviderEvents;\n\n/**\n * @summary A class for emitting provider events\n * @since 0.2.0\n */\nexport class EventEmitter {\n  constructor() {\n    this.events = new Map();\n  }\n\n  /**\n   * @summary A map of events and their listeners\n   * @private\n   */\n  private events: Map<ProviderEventName, Array<Function>>;\n\n  /**\n   * @summary Adds a listener to the event\n   * @public\n   * @param {string} event Event name\n   * @param {Function} callback Callback function\n   * @returns {EventEmitter} The instance of the class itself\n   */\n  public on(event: ProviderEventName, callback: Function) {\n    if (!this.events.has(event)) {\n      this.events.set(event, []);\n    }\n    this.events.get(event)!.push(callback);\n    return this;\n  }\n\n  /**\n   * @summary Removes a listener from the event\n   * @public\n   * @param {string} event Event name\n   * @param {Function} callback Callback function\n   * @returns {EventEmitter} The instance of the class itself\n   */\n  public removeListener(event: ProviderEventName, callback: Function) {\n    if (this.events.has(event)) {\n      const callbacks = this.events.get(event)!.filter((cb) => cb !== callback);\n      this.events.set(event, callbacks);\n    }\n    return this;\n  }\n\n  /**\n   * @summary Emits an event\n   * @public\n   * @param {string} event Event name\n   * @param data Event data\n   * @returns {EventEmitter} The instance of the class itself\n   */\n  protected emit(event: ProviderEventName, ...data: any[]) {\n    if (this.events.has(event)) {\n      console.log('[Grindery.WalletSDK] > Event:', event, data[0]);\n      this.events.get(event)!.forEach((callback) => {\n        callback(...data);\n      });\n    }\n    return this;\n  }\n}\n","import { CHAINS } from '../utils/chains';\nimport { uuid } from '../utils/uuid';\n\nconst LOCALSTORAGE_KEY = 'GrinderyWalletProvider';\n\n/**\n * @summary SdkStorage keys\n * @since 0.2.0\n */\nexport enum SdkStorageKeys {\n  pairingToken = 'pairingToken',\n  sessionId = 'sessionId',\n  connectUrl = 'connectUrl',\n  connectUrlBrowser = 'connectUrlBrowser',\n  shortToken = 'shortToken',\n  clientId = 'clientId',\n  address = 'address',\n  chainId = 'chainId',\n}\n\n/**\n * @summary SdkStorage key type\n * @since 0.2.0\n */\nexport type SdkStorageKey = keyof typeof SdkStorageKeys;\n\nexport type SdkStorageSnapshot = {\n  [key in SdkStorageKeys]?: string;\n};\n\n/**\n * @summary A class to handle local storage\n * @since 0.2.0\n */\nexport class SdkStorage {\n  /**\n   * @summary Gets the value of the storage by the key\n   * @public\n   * @param {SdkStorageKey} key Provider storage key\n   * @returns {string} The value of the storage by the key\n   */\n  public getValue(key: SdkStorageKey): string {\n    const value = this.getSnapshot()[key] || '';\n    return value;\n  }\n\n  /**\n   * @summary Sets the value of the storage by the key\n   * @public\n   * @param {SdkStorageKey} key Provider storage key\n   * @param {string} value The value to set\n   * @returns {void}\n   */\n  public setValue(key: SdkStorageKey, value: string): string {\n    const snapshot = this.getSnapshot();\n    snapshot[key] = value;\n    this.saveSnapshot(snapshot);\n    return value;\n  }\n\n  /**\n   * @summary Clears the storage\n   * @public\n   * @returns {void}\n   */\n  public clear(): void {\n    this.saveSnapshot({\n      clientId: this.getSnapshot().clientId || uuid(),\n      chainId: this.getSnapshot().chainId || CHAINS[0],\n    });\n  }\n\n  /**\n   * @summary Gets the storage\n   * @since 0.2.0\n   * @returns {SdkStorageSnapshot} The storage snapshot object\n   */\n  private getSnapshot(): SdkStorageSnapshot {\n    try {\n      return JSON.parse(\n        localStorage.getItem(LOCALSTORAGE_KEY) || '{}'\n      ) as SdkStorageSnapshot;\n    } catch (error) {\n      localStorage.setItem(LOCALSTORAGE_KEY, JSON.stringify({}));\n      throw new Error('Error parsing storage');\n    }\n  }\n\n  /**\n   * @summary Saves the storage\n   * @since 0.2.0\n   * @param {SdkStorageSnapshot} storage SdkStorage snapshot object\n   */\n  private saveSnapshot(storage: SdkStorageSnapshot): void {\n    localStorage.setItem(LOCALSTORAGE_KEY, JSON.stringify(storage));\n  }\n}\n","/**\n * @summary Generates a Version 4 (pseudorandom) UUID\n * @returns {string} The UUID\n */\nexport const uuid = (): string => {\n  let d = '';\n  while (d.length < 32) d += Math.random().toString(16).substr(2);\n  const vr = ((parseInt(d.substr(16, 1), 16) & 0x3) | 0x8).toString(16);\n  return `${d.substr(0, 8)}-${d.substr(8, 4)}-4${d.substr(\n    13,\n    3\n  )}-${vr}${d.substr(17, 3)}-${d.substr(20, 12)}`;\n};\n","import { uuid } from './uuid';\n\n/**\n * Represents the assets needed to display a wallet\n *\n * @since 0.1.1\n * @link https://eips.ethereum.org/EIPS/eip-6963#provider-info\n */\nexport interface EIP6963ProviderInfo {\n  uuid: string;\n  name: string;\n\n  /**\n   * Data URI as defined in RFC-2397.\n   *\n   * The image SHOULD be a square with 96x96px minimum resolution.\n   * The image format is RECOMMENDED to be either lossless or vector based such as PNG, WebP or SVG.\n   * @link https://eips.ethereum.org/EIPS/eip-6963#imagesicons\n   */\n  icon: string;\n\n  /**\n   * MUST BE a valid RFC-1034 Domain Name\n   * @link https://eips.ethereum.org/EIPS/eip-6963#rdns\n   */\n  rdns: string;\n}\n\nexport const providerInfo: EIP6963ProviderInfo = {\n  uuid: uuid(),\n  name: 'Grindery Wallet',\n  rdns: 'com.grindery.wallet',\n  icon: 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iOTYiIGhlaWdodD0iOTYiIHZpZXdCb3g9IjAgMCA5NiA5NiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9Ijk2IiBoZWlnaHQ9Ijk2IiByeD0iNDgiIGZpbGw9IiMwQjBEMTciLz4KPHBhdGggZD0iTTUyLjcwOTMgNTQuNjI5NUw0My40MDAzIDYwLjU2MTdDNDEuOTkwMiA2MS40NjAzIDQxLjU4OTQgNjMuMzEwNSA0Mi41MDUxIDY0LjY5NDJDNDMuNDA5NyA2Ni4wNjExIDQ1LjI2MDYgNjYuNDYxNSA0Ni42NjQ4IDY1LjYwNDhMNTIuNDQ4MiA2MS43MjY5TDU3LjU1NjggNTguMjk1MUM1Ny42MzgyIDU4LjI0MTkgNTcuNzE5MyA1OC4xODk2IDU3LjgwMDMgNTguMTM4NEw1OC4wNTgxIDU3Ljk2NTVDNTguMjA1MyA1Ny44NjY4IDU4LjM1NzggNTcuNzgxMyA1OC41MTQxIDU3LjcwODlDNTguNjQwNiA1Ny42MzY5IDU4Ljc2NjYgNTcuNTY3MyA1OC44OTIxIDU3LjUwMDFDNjEuOTUwMSA1NS44NjQ0IDY1Ljc4MDQgNTYuOTcwOSA2Ny40NDczIDU5Ljk3MTdDNjguOTA3NSA2Mi42MDAzIDY4LjI0MDggNjUuODc3NiA2NS44NjQgNjcuNzU0NUM2Ni4yMzc2IDY2Ljg3NDggNjYuMTc2OCA2NS44MzUyIDY1LjYwNzkgNjQuOTc1NUM2NC43MDMzIDYzLjYwODYgNjIuODUyNCA2My4yMDgzIDYxLjQ0ODIgNjQuMDY1TDU1LjY2NDggNjcuOTQyOEw1MC41NTYyIDcxLjM3NDdDNTAuNTA3OSA3MS40MDU1IDUwLjQ1OTQgNzEuNDM1OCA1MC40MTA3IDcxLjQ2NTdMNTAuMDU1IDcxLjcwNDJDNDkuNzU1OCA3MS45MDQ5IDQ5LjQzNDkgNzIuMDUwNiA0OS4xMDQ3IDcyLjE0MzhDNDQuNjU3MyA3NC4wNTkyIDM5LjMyMzggNzIuNTg5NCAzNi41OTI0IDY4LjQ2MjFDMzMuNzUxNiA2NC4xNjk2IDM0LjczMTcgNTguNTIzNCAzOC42OTg2IDU1LjM3MzZDMzYuODE0IDU0LjY1NzkgMzUuMDI3NSA1My41OTk1IDMzLjQzNjEgNTIuMTkzNEMyNi40MzA0IDQ2LjAwMzYgMjUuODU3NyAzNS40MjA1IDMyLjE1NjkgMjguNTU1NEMzOC40NTYyIDIxLjY5MDQgNDkuMjQxOSAyMS4xNDMxIDU2LjI0NzYgMjcuMzMyOUM2My4yNTMzIDMzLjUyMjggNjMuODI2IDQ0LjEwNTkgNTcuNTI2NyA1MC45NzA5QzU2LjExNTIgNTIuNTA5MyA1NC40Nzg0IDUzLjczMDQgNTIuNzA5MyA1NC42Mjk1Wk01MS44MDcgNDYuMDUxNkM1NS40MjMgNDIuMDgyMyA1NS4wOTQzIDM1Ljk2MzEgNTEuMDcyNyAzMi4zODQxQzQ3LjA1MTEgMjguODA1MiA0MC44NTk1IDI5LjEyMTYgMzcuMjQzNSAzMy4wOTFDMzMuNjI3NCAzNy4wNjA0IDMzLjk1NjIgNDMuMTc5NSAzNy45Nzc4IDQ2Ljc1ODVDNDEuOTk5NCA1MC4zMzc1IDQ4LjE5MDkgNTAuMDIxIDUxLjgwNyA0Ni4wNTE2WiIgZmlsbD0id2hpdGUiLz4KPC9zdmc+Cg==',\n};\n","/**\n * @summary Error class for wallet Provider\n * @since 0.1.0\n * @extends Error\n */\nexport class ProviderError extends Error {\n  name: string = 'GrinderyWalletProviderError';\n  code?: number;\n  data?: unknown;\n\n  constructor(message: string, code?: number, data?: unknown) {\n    super(message);\n    this.code = code;\n    this.data = data;\n  }\n}\n\nexport const ProviderErrors = {\n  PairingFailed: new ProviderError('Pairing failed', 4900),\n  Disconnected: new ProviderError('Disconnected', 4900),\n  UnsupportedMethod: new ProviderError('Unsupported Method', 4200),\n  Unauthorized: new ProviderError('Unauthorized', 4100),\n  NoResult: new ProviderError('No result', 4900),\n  NoAppId: new ProviderError('App ID is required', 4900),\n  UserRejected: new ProviderError('User Rejected Request', 4001),\n  ChainDisconnected: new ProviderError('Chain Disconnected', 4901),\n};\n\nexport const newProviderError = (error?: unknown): ProviderError => {\n  let errorResponse: ProviderError;\n  if (error instanceof ProviderError) {\n    errorResponse = new ProviderError(\n      error.message || 'Unknown error',\n      error.code || 4900,\n      error.data\n    );\n  } else if (error instanceof Error) {\n    errorResponse = new ProviderError(\n      error.message || 'Unknown error',\n      4900,\n      error\n    );\n  } else {\n    errorResponse = new ProviderError('Unknown error', 4900, error);\n  }\n  return errorResponse;\n};\n","/**\n * Supported chains list\n *\n * @description Currently supports the following chains: Polygon, BNB Smart Chain, and opBNB Smart Chain\n *\n * @since 0.3.0\n * @type {string[]} Chain ids in CAIP-2 format\n */\nexport const CHAINS: string[] = ['eip155:137', 'eip155:56', 'eip155:204'];\n\nexport const hexChainId = (chainId: string): string => {\n  return `0x${parseInt(chainId.split(':')[1], 10).toString(16)}`;\n};\n\nexport const unhexChainId = (hexChainId: string): string => {\n  return `eip155:${parseInt(hexChainId, 16)}`;\n};\n","import { ProviderError, ProviderErrors } from './ProviderError';\nimport { SdkStorage, SdkStorageKeys } from './SdkStorage';\nimport { WalletSDKConfig } from './WalletSDK';\n\n/**\n * @summary The Grindery RPC API method names\n * @updated 0.7.0 Added `requestPairingByUserId` and `requestPairingByTelegramLogin` methods\n */\nexport enum RpcMethodNames {\n  requestPairing = 'requestPairing',\n  waitForPairingResult = 'waitForPairingResult',\n  request = 'request',\n  waitForRequestResult = 'waitForRequestResult',\n  'disconnect' = 'disconnect',\n  getUserWalletAddress = 'getUserWalletAddress',\n  trackClientEvent = 'trackClientEvent',\n\n  /**\n   * Server side method\n   * @since 0.7.0\n   */\n  requestPairingByUserId = 'requestPairingByUserId',\n  /**\n   * Server side method\n   * @since 0.7.0\n   */\n  requestPairingByTelegramLogin = 'requestPairingByTelegramLogin',\n}\n\n/**\n * @summary The Grindery RPC API request results\n * @since 0.2.0\n */\nexport namespace RpcRequestResults {\n  /**\n   * @summary `waitForPairingResult` method result\n   */\n  export type waitForPairingResult = {\n    session: {\n      expiry: number;\n      sessionId: string;\n      namespaces: {\n        [key: string]: {\n          accounts: string[];\n          chains: string[];\n          events: string[];\n          methods: string[];\n        };\n      };\n    };\n  };\n\n  /**\n   * @summary `requestPairing` method result\n   */\n  export type requestPairing = {\n    config?: WalletSDKConfig;\n    pairingToken: string;\n    connectUrl: string;\n    connectUrlBrowser: string;\n    shortToken: string;\n    miniAppPairingToken?: string;\n  };\n\n  /**\n   * @summary `request` method result\n   */\n  export type request = {\n    requestToken: string;\n  };\n\n  /**\n   * @summary `waitForRequestResult` method result\n   */\n  export type waitForRequestResult = any;\n\n  /**\n   * @summary `disconnect` method result\n   */\n  export type disconnect = boolean;\n\n  /**\n   * @summary `getUserWalletAddress` method result\n   */\n  export type getUserWalletAddress = string;\n\n  /**\n   * @summary `trackClientEvent` method result\n   */\n  export type trackClientEvent = true;\n\n  /**\n   * @summary `requestPairingByUserId` method result\n   * @since 0.7.0\n   */\n  export type requestPairingByUserId = { pairingToken: string };\n\n  /**\n   * @summary `requestPairingByTelegramLogin` method result\n   * @since 0.7.0\n   */\n  export type requestPairingByTelegramLogin = { pairingToken: string };\n}\n\n/**\n * @summary The Grindery RPC API wrapper class\n * @since 0.2.0\n */\nexport class Rpc {\n  private config: WalletSDKConfig;\n\n  constructor(config: WalletSDKConfig) {\n    this.config = config;\n  }\n\n  /**\n   * @summary Sends a provider request to the Grindery RPC API and waits for the result.\n   * @public\n   * @param {RpcMethodNames} method Provider request method name\n   * @param {Array} params Provider request parameters\n   * @param {number} timeout Optional. The time in milliseconds to wait for the request result. Default is 30000.\n   * @returns The result of the provider request\n   */\n  public async sendAndWaitRpcRequest<T>(\n    method: string,\n    params?: readonly unknown[],\n    timeout?: number\n  ): Promise<T> {\n    const request = await this.sendRpcRequest(method, params);\n    return await this.waitRpcRequest(request.requestToken, timeout);\n  }\n\n  /**\n   * @summary Sends a provider request to the Grindery RPC API.\n   * @protected\n   * @param {RpcMethodNames} method Provider request method name\n   * @param {Array} params Provider request parameters\n   * @returns {RpcRequestResults.request} Promise resolving with the request token to use in the `waitGrinderyRpcProviderRequest` method\n   */\n  protected async sendRpcRequest(\n    method: string,\n    params?: readonly unknown[]\n  ): Promise<RpcRequestResults.request> {\n    const storage = new SdkStorage();\n    return await this.sendRpcApiRequest<RpcRequestResults.request>(\n      RpcMethodNames.request,\n      {\n        sessionId: storage.getValue(SdkStorageKeys.sessionId),\n        scope: storage.getValue(SdkStorageKeys.chainId),\n        request: {\n          method,\n          params,\n        },\n      }\n    );\n  }\n\n  /**\n   * @summary Waits for the result of the provider request.\n   * @protected\n   * @param {string} requestToken A token to identify provider request. Recieved in the results of `sendGrinderyRpcProviderRequest` method.\n   * @param {number} timeout Optional. The time in milliseconds to wait for the request result. Default is 30000.\n   * @returns The result of the provider request\n   */\n  protected async waitRpcRequest<T>(\n    requestToken: string,\n    timeout?: number\n  ): Promise<T> {\n    return await this.sendRpcApiRequest<T>(\n      RpcMethodNames.waitForRequestResult,\n      {\n        requestToken,\n        timeout,\n      }\n    );\n  }\n\n  /**\n   * @summary Sends a request to the Grindery Walletconnect RPC API.\n   * @public\n   * @param {RpcMethodNames} method Request method name\n   * @param {RequestArgumentsParams} params Request parameters\n   * @returns {T} The result of the request\n   */\n  public async sendRpcApiRequest<T>(\n    method: RpcMethodNames,\n    params?: unknown[] | object\n  ): Promise<T> {\n    try {\n      const response = await fetch(\n        this.config.pairingApiUrl || 'https://walletconnect-api.grindery.com',\n        {\n          method: 'POST',\n          headers: {\n            'Content-Type': 'application/json',\n          },\n          body: JSON.stringify({\n            jsonrpc: '2.0',\n            id: 1,\n            method: `gws_${method}`,\n            params: params || [],\n          }),\n        }\n      );\n      const data = await response.json();\n      if (data.error) {\n        throw new ProviderError(data.error.message, data.error.code);\n      }\n      if (!data.result) {\n        throw ProviderErrors.NoResult;\n      }\n      return data.result;\n    } catch (error) {\n      if (error instanceof Error) {\n        throw new ProviderError(error.message, 500, error);\n      }\n      throw new ProviderError('Server error', 500, error);\n    }\n  }\n}\n","import { providerInfo } from '../utils/providerInfo';\nimport { EventEmitter, ProviderEvents } from './EventEmitter';\nimport { ProviderErrors, newProviderError } from './ProviderError';\nimport { Rpc, RpcMethodNames, RpcRequestResults } from './Rpc';\nimport { SdkStorage, SdkStorageKeys } from './SdkStorage';\nimport { CHAINS, hexChainId, unhexChainId } from '../utils/chains';\nimport { WalletSDKConfig } from './WalletSDK';\n\n/**\n * @summary The Grindery wallet provider methods\n * @since 0.2.0\n */\nexport type ProviderMethods = {\n  [name in ProviderMethodNames]: (\n    params?: ProviderRequestArgumentsParams\n  ) => Promise<unknown>;\n};\n\n/**\n * @summary The Grindery wallet provider method names\n * @since 0.2.0\n * @since 0.3.0 Added `eth_chainId`, `wallet_addEthereumChain` and `wallet_switchEthereumChain` methods\n */\nexport enum ProviderMethodNames {\n  eth_requestAccounts = 'eth_requestAccounts',\n  eth_accounts = 'eth_accounts',\n  personal_sign = 'personal_sign',\n  eth_sendTransaction = 'eth_sendTransaction',\n  gws_disconnect = 'gws_disconnect',\n  eth_chainId = 'eth_chainId',\n  wallet_addEthereumChain = 'wallet_addEthereumChain',\n  wallet_switchEthereumChain = 'wallet_switchEthereumChain',\n}\n\nexport namespace ProviderRequestResults {\n  export type eth_accounts = string[];\n  export type eth_requestAccounts = string[];\n  export type personal_sign = string;\n  export type eth_sendTransaction = string;\n  export type disconnect = boolean;\n  export type wallet_switchEthereumChain = null;\n  export type wallet_addEthereumChain = null;\n  export type eth_chainId = string;\n}\n\n/**\n * @summary The Grindery wallet provider method names\n * @since 0.2.0\n */\nexport type ProviderMethodName = keyof typeof ProviderMethodNames;\n\n/**\n * @summary The Grindery wallet provider request params\n * @since 0.2.0\n */\nexport type ProviderRequestArgumentsParams = readonly unknown[] | object;\n\n/**\n * @summary The Grindery wallet provider request arguments\n * @since 0.2.0\n */\nexport interface ProviderRequestArguments {\n  readonly method: ProviderMethodName;\n  readonly params?: ProviderRequestArgumentsParams;\n}\n\n/**\n * @summary The base wallet provider class\n * @since 0.2.0\n * @extends EventEmitter\n */\nexport class Provider extends EventEmitter {\n  public isGrinderyWallet: boolean = true;\n  private config: WalletSDKConfig;\n\n  constructor(config: WalletSDKConfig) {\n    super();\n    this.config = config;\n    this.rpc = new Rpc(this.config);\n    if (this.config?.appId) {\n      this.injectProvider();\n      this.listenForRequestProviderEvents();\n      this.announceProvider();\n    }\n    if (typeof window !== 'undefined') {\n      window.addEventListener('load', () => {\n        this.restoreConnection();\n      });\n    }\n  }\n\n  public restoreConnection(): void {\n    if (this.config?.appId) {\n      this.emit(ProviderEvents.connect, {\n        chainId: hexChainId(\n          this.storage.getValue(SdkStorageKeys.chainId) ||\n            this.config?.chainId ||\n            CHAINS[0]\n        ),\n      });\n      this.restorePairing();\n      this.restoreSession();\n    }\n  }\n\n  /**\n   * @public\n   * @returns {boolean} True if the provider is connected to the server.\n   */\n  public isConnected(): boolean {\n    // Always true\n    return true;\n  }\n\n  /**\n   * @summary Sends a request to the provider\n   * @public\n   * @param {ProviderRequestArguments} args Request arguments\n   * @param {string} args.method The method name\n   * @param {ProviderRequestArgumentsParams} args.params The method parameters\n   * @returns {T} The result of the request\n   */\n  public async request<T>({\n    method,\n    params,\n  }: ProviderRequestArguments): Promise<T> {\n    return (await this.methods[method]?.(params)) as T;\n  }\n\n  /**\n   * @summary Sends a request to the provider (legacy)\n   * @public\n   * @param {ProviderRequestArguments} args Request arguments\n   * @param {string} args.method The method name\n   * @param {ProviderRequestArgumentsParams} args.params The method parameters\n   * @param {Function} callback The callback function\n   * @deprecated Use `request` method instead\n   * @since 0.5.4\n   * @returns {void} `void`\n   */\n  public sendAsync(\n    { method, params }: ProviderRequestArguments,\n    callback: Function\n  ): void {\n    this.methods[method]?.(params)\n      .then((res) => {\n        callback(null, res);\n      })\n      .catch((error) => {\n        callback(error);\n      });\n  }\n\n  private storage: SdkStorage = new SdkStorage();\n\n  private rpc: Rpc;\n\n  /**\n   * @summary Switches the chain\n   * @since 0.3.0\n   * @param {string} chainId Chain id in hex format\n   * @returns {null} `Null` on success\n   */\n  private switchChain = async ({ chainId }: any): Promise<null> => {\n    const chainCaip = unhexChainId(chainId);\n    if (!CHAINS.includes(chainCaip)) {\n      throw newProviderError(ProviderErrors.ChainDisconnected);\n    }\n    this.storage.setValue(SdkStorageKeys.chainId, chainCaip);\n    this.emit(ProviderEvents.chainChanged, { chainId });\n    return null;\n  };\n\n  /**\n   * @summary The list of supported provider methods.\n   * @private\n   */\n  private methods: Partial<ProviderMethods> = {\n    /**\n     * @summary The `eth_requestAccounts` provider method\n     */\n    [ProviderMethodNames.eth_requestAccounts]: async (\n      params?: ProviderRequestArgumentsParams\n    ): Promise<ProviderRequestResults.eth_requestAccounts> => {\n      if (!this.config.appId) {\n        throw newProviderError(ProviderErrors.NoAppId);\n      }\n      if (this.storage.getValue('sessionId')) {\n        try {\n          return await this.request<ProviderRequestResults.eth_accounts>({\n            method: ProviderMethodNames.eth_accounts,\n            params: [],\n          });\n        } catch (error) {\n          this.storage.setValue(SdkStorageKeys.sessionId, '');\n          // skip failed request and continue with pairing\n        }\n      }\n      if (this.storage.getValue('pairingToken')) {\n        try {\n          const pairResult =\n            await this.rpc.sendRpcApiRequest<RpcRequestResults.waitForPairingResult>(\n              RpcMethodNames.waitForPairingResult,\n              {\n                pairingToken: this.storage.getValue(\n                  SdkStorageKeys.pairingToken\n                ),\n              }\n            );\n\n          this.storage.clear();\n          this.storage.setValue(\n            SdkStorageKeys.sessionId,\n            pairResult.session.sessionId\n          );\n\n          if (!pairResult.session.sessionId) {\n            throw ProviderErrors.PairingFailed;\n          }\n\n          return await this.request<ProviderRequestResults.eth_accounts>({\n            method: ProviderMethodNames.eth_accounts,\n            params: params || [],\n          });\n        } catch (error) {\n          this.storage.clear();\n          // skip failed request and continue with pairing\n        }\n      }\n      try {\n        this.storage.clear();\n        const result =\n          await this.rpc.sendRpcApiRequest<RpcRequestResults.requestPairing>(\n            RpcMethodNames.requestPairing,\n            {\n              appId: this.config?.appId || '',\n              clientId: this.storage.getValue(SdkStorageKeys.clientId),\n              redirectMode: this.config?.redirectMode,\n              redirectUrl: this.config?.appUrl,\n            }\n          );\n\n        if (!result.pairingToken || !result.connectUrl) {\n          throw ProviderErrors.PairingFailed;\n        }\n\n        this.storage.setValue(SdkStorageKeys.pairingToken, result.pairingToken);\n        this.storage.setValue(SdkStorageKeys.connectUrl, result.connectUrl);\n        this.storage.setValue(\n          SdkStorageKeys.connectUrlBrowser,\n          result.connectUrlBrowser\n        );\n        this.storage.setValue(SdkStorageKeys.shortToken, result.shortToken);\n        this.emit(ProviderEvents.pair, {\n          config: this.config,\n          shortToken: result.shortToken,\n          connectUrl: result.connectUrl,\n          connectUrlBrowser: result.connectUrlBrowser,\n          miniAppPairingToken: result.miniAppPairingToken,\n        });\n        const pairResult =\n          await this.rpc.sendRpcApiRequest<RpcRequestResults.waitForPairingResult>(\n            RpcMethodNames.waitForPairingResult,\n            {\n              pairingToken: result.pairingToken,\n            }\n          );\n\n        this.storage.setValue(\n          SdkStorageKeys.sessionId,\n          pairResult.session.sessionId\n        );\n\n        if (!pairResult.session.sessionId) {\n          throw ProviderErrors.PairingFailed;\n        }\n        this.storage.setValue(SdkStorageKeys.pairingToken, '');\n        this.storage.setValue(SdkStorageKeys.connectUrl, '');\n        this.storage.setValue(SdkStorageKeys.connectUrlBrowser, '');\n        this.storage.setValue(SdkStorageKeys.shortToken, '');\n\n        return await this.request({\n          method: ProviderMethodNames.eth_accounts,\n          params: params || [],\n        });\n      } catch (error) {\n        throw error;\n      }\n    },\n\n    /**\n     * @summary The `eth_accounts` provider method\n     */\n    [ProviderMethodNames.eth_accounts]: async (\n      params?: ProviderRequestArgumentsParams\n    ): Promise<ProviderRequestResults.eth_accounts> => {\n      try {\n        const result = (await this.rpc.sendAndWaitRpcRequest<string[]>(\n          ProviderMethodNames.eth_accounts,\n          params ? (Array.isArray(params) ? params : [params]) : []\n        )) as ProviderRequestResults.eth_accounts;\n        this.storage.setValue(SdkStorageKeys.address, result[0] || '');\n        this.emit(ProviderEvents.accountsChanged, result);\n        return result;\n      } catch (error) {\n        throw newProviderError(error);\n      }\n    },\n\n    /**\n     * @summary The `eth_sendTransaction` provider method\n     */\n    [ProviderMethodNames.eth_sendTransaction]: async (\n      params?: ProviderRequestArgumentsParams\n    ): Promise<ProviderRequestResults.eth_sendTransaction> => {\n      return (await this.rpc.sendAndWaitRpcRequest(\n        ProviderMethodNames.eth_sendTransaction,\n        params ? (Array.isArray(params) ? params : [params]) : []\n      )) as ProviderRequestResults.eth_sendTransaction;\n    },\n\n    /**\n     * @summary The `personal_sign` provider method\n     */\n    [ProviderMethodNames.personal_sign]: async (\n      params?: Partial<ProviderRequestArgumentsParams>\n    ): Promise<ProviderRequestResults.personal_sign> => {\n      return (await this.rpc.sendAndWaitRpcRequest(\n        ProviderMethodNames.personal_sign,\n        params ? (Array.isArray(params) ? params : [params]) : []\n      )) as ProviderRequestResults.personal_sign;\n    },\n\n    /**\n     * @summary The `gws_disconnect` provider method\n     */\n    [ProviderMethodNames.gws_disconnect]:\n      async (): Promise<ProviderRequestResults.disconnect> => {\n        try {\n          const result =\n            await this.rpc.sendRpcApiRequest<ProviderRequestResults.disconnect>(\n              RpcMethodNames.disconnect,\n              {\n                sessionToken: this.storage.getValue(SdkStorageKeys.sessionId),\n              }\n            );\n\n          this.emit(ProviderEvents.disconnect, ProviderErrors.Disconnected);\n\n          return result;\n        } catch (error) {\n          throw newProviderError(error);\n        }\n      },\n\n    /**\n     * @summary The `eth_chainId` provider method\n     * @since 0.3.0\n     */\n    [ProviderMethodNames.eth_chainId]: async (\n      _?: ProviderRequestArgumentsParams\n    ): Promise<ProviderRequestResults.eth_chainId> => {\n      return hexChainId(\n        this.storage.getValue(SdkStorageKeys.chainId) ||\n          this.config?.chainId ||\n          CHAINS[0]\n      );\n    },\n\n    /**\n     * @summary The `wallet_addEthereumChain` provider method\n     * @since 0.3.0\n     */\n    [ProviderMethodNames.wallet_addEthereumChain]: async (\n      _?: ProviderRequestArgumentsParams\n    ): Promise<ProviderRequestResults.wallet_addEthereumChain> => {\n      throw newProviderError(ProviderErrors.UserRejected);\n    },\n\n    /**\n     * @summary The `wallet_switchEthereumChain` provider method\n     * @since 0.3.0\n     */\n    [ProviderMethodNames.wallet_switchEthereumChain]: async (\n      params?: ProviderRequestArgumentsParams\n    ): Promise<ProviderRequestResults.wallet_switchEthereumChain> =>\n      await this.switchChain(params),\n  };\n\n  /**\n   * @summary Restores the pairing process if pairing token is stored in the local storage\n   * @private\n   * @returns {void}\n   */\n  private async restorePairing(): Promise<void> {\n    const pairingToken = this.storage.getValue(SdkStorageKeys.pairingToken);\n    const sessionId = this.storage.getValue(SdkStorageKeys.sessionId);\n    if (pairingToken && !sessionId) {\n      try {\n        const pairResult =\n          await this.rpc.sendRpcApiRequest<RpcRequestResults.waitForPairingResult>(\n            RpcMethodNames.waitForPairingResult,\n            {\n              pairingToken,\n            }\n          );\n\n        this.storage.clear();\n        this.storage.setValue(\n          SdkStorageKeys.sessionId,\n          pairResult.session.sessionId\n        );\n\n        if (!pairResult.session.sessionId) {\n          throw ProviderErrors.PairingFailed;\n        }\n\n        const accounts = (\n          pairResult.session?.namespaces?.[`eip155`]?.accounts || []\n        ).map((account) =>\n          account.includes(':') ? account.split(':')[2] || '' : account\n        );\n        this.storage.setValue(SdkStorageKeys.address, accounts[0] || '');\n        this.emit(ProviderEvents.accountsChanged, accounts);\n      } catch (error) {\n        this.storage.clear();\n      }\n    }\n  }\n\n  /**\n   * @summary Restores the session if session Id is stored in the local storage\n   * @private\n   * @returns {void}\n   */\n  private async restoreSession(): Promise<void> {\n    const pairingToken = this.storage.getValue(SdkStorageKeys.pairingToken);\n    const sessionId = this.storage.getValue(SdkStorageKeys.sessionId);\n    if (sessionId && !pairingToken) {\n      try {\n        await this.request<string[]>({\n          method: ProviderMethodNames.eth_requestAccounts,\n        });\n      } catch (error) {\n        this.storage.clear();\n      }\n    }\n  }\n\n  /**\n   * @summary Injects the provider into the window object\n   * @private\n   * @returns {void}\n   */\n  private injectProvider(): void {\n    if (typeof window !== 'undefined') {\n      if (!window.ethereum) {\n        window.ethereum = this;\n      } else {\n        if (\n          window.ethereum.providers &&\n          Array.isArray(window.ethereum.providers)\n        ) {\n          if (\n            window.ethereum.providers.filter((p: any) => p.isGrinderyWallet)\n              .length > 0\n          ) {\n            window.ethereum.providers = window.ethereum.providers.map(\n              (p: any) => {\n                if (p.isGrinderyWallet) {\n                  return this;\n                }\n                return p;\n              }\n            );\n          } else {\n            window.ethereum.providers.push(this);\n          }\n        } else {\n          window.ethereum.providers = [window.ethereum, this];\n        }\n      }\n    }\n  }\n\n  /**\n   * @summary Announces the provider to the window object\n   * @private\n   * @since 0.1.1\n   * @link https://eips.ethereum.org/EIPS/eip-6963#announce-and-request-events\n   * @returns {void}\n   */\n  private announceProvider(): void {\n    if (typeof window !== 'undefined') {\n      window.dispatchEvent(\n        new CustomEvent('eip6963:announceProvider', {\n          detail: Object.freeze({ info: providerInfo, provider: this }),\n        })\n      );\n    }\n  }\n\n  /**\n   * @summary Listens for the request provider events\n   * @private\n   * @since 0.1.1\n   * @link https://eips.ethereum.org/EIPS/eip-6963#announce-and-request-events\n   * @returns {void}\n   */\n  private listenForRequestProviderEvents(): void {\n    if (typeof window !== 'undefined') {\n      window.addEventListener('eip6963:requestProvider', () => {\n        this.announceProvider();\n      });\n    }\n  }\n}\n","import { WalletSDK } from './classes/WalletSDK';\n\ndeclare global {\n  interface Window {\n    ethereum?: any;\n    Grindery?: {\n      appId?: string;\n      appUrl?: string;\n      redirectMode?: string;\n      pairingApiUrl?: string;\n      walletApiUrl?: string;\n      chainId?: string;\n      WalletSDK?: WalletSDK;\n    };\n  }\n}\n\n/**\n * @summary The Grindery Wallet SDK\n */\nexport const GrinderyWalletSDK = WalletSDK;\n\nfunction init() {\n  if (\n    typeof window !== 'undefined' &&\n    (!window.Grindery?.WalletSDK ||\n      !(window.Grindery.WalletSDK instanceof WalletSDK))\n  ) {\n    window.Grindery = {\n      ...(window.Grindery || {}),\n      WalletSDK: new WalletSDK(),\n    };\n  }\n}\n\n// Initialize the SDK\ninit();\n","import { SdkStorage, SdkStorageKeys } from './SdkStorage';\n\n/**\n * @summary The Grindery Wallet API wrapper class\n * @since 0.5.0\n */\nexport class WalletAPI {\n  /**\n   * @summary Sends a request to the Grindery Wallet API\n   * @public\n   * @param {string} method JSON-RPC method name\n   * @param {object} params JSON-RPC method parameters, optional\n   * @returns {T} The result of the API request\n   */\n  public async sendApiRequest<T>(method: string, params?: object): Promise<T> {\n    const storage = new SdkStorage();\n    const sessionId = storage.getValue(SdkStorageKeys.sessionId);\n    const address = storage.getValue(SdkStorageKeys.address);\n    if (!sessionId || !address) {\n      throw new Error('Not connected to the wallet');\n    }\n    const customUrl =\n      typeof window !== 'undefined' &&\n      window.Grindery?.WalletSDK?.config.walletApiUrl\n        ? window.Grindery.WalletSDK.config.walletApiUrl\n        : '';\n    const response = await fetch(\n      customUrl || 'https://wallet-api.grindery.com/v3',\n      {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          Authorization: `Bearer ${address}:${sessionId}`,\n        },\n        body: JSON.stringify({\n          jsonrpc: '2.0',\n          id: 1,\n          method,\n          params: params || {},\n        }),\n      }\n    );\n\n    if (!response.ok) {\n      throw new Error(`Failed to call ${method}`);\n    }\n    const json = await response.json();\n    return json.result as T;\n  }\n}\n","import { ProviderEventName, ProviderEvents } from './EventEmitter';\nimport { Provider, ProviderMethodNames } from './Provider';\nimport { Rpc, RpcMethodNames, RpcRequestResults } from './Rpc';\nimport { SdkStorage, SdkStorageKeys } from './SdkStorage';\nimport { CHAINS, hexChainId } from '../utils/chains';\nimport { User } from '../utils/user';\nimport { WalletAPI } from './WalletAPI';\nimport { getConfigFromDataAttributes } from '../utils/getConfigFromDataAttributes';\nimport { TelegramLoginInfo } from '../utils/telegram';\n\nexport type WalletSDKConfig = {\n  /**\n   * @summary The application ID, obtained in the Grindery bot by the dApp developer.\n   */\n  appId: string;\n  /**\n   * @summary The application URL. If not provided, the current page URL will be used.\n   */\n  appUrl: string;\n  /**\n   * @summary The pairing API URL. If not provided, the default Grindery API URL will be used.\n   */\n  pairingApiUrl?: string;\n  /**\n   * @summary The wallet API URL. If not provided, the default Grindery API URL will be used.\n   */\n  walletApiUrl?: string;\n  /**\n   * @summary The redirect mode for the pairing request.\n   * @example 'tg' | 'url' | 'close'\n   */\n  redirectMode?: string;\n  /**\n   * @summary The default chain ID in CAIP-2 format.\n   */\n  chainId?: string;\n};\n\n/**\n * @summary The Wallet SDK class\n * @since 0.2.0\n */\nexport class WalletSDK {\n  /**\n   * @summary The provider instance\n   * @public\n   */\n  public provider: Provider;\n\n  public config: WalletSDKConfig =\n    typeof window !== 'undefined'\n      ? {\n          appId: window.Grindery?.appId || '',\n          appUrl: window.Grindery?.appUrl || window.location.origin,\n          redirectMode: window.Grindery?.redirectMode,\n          pairingApiUrl: window.Grindery?.pairingApiUrl,\n          walletApiUrl: window.Grindery?.walletApiUrl,\n          chainId: window.Grindery?.chainId,\n        }\n      : {\n          appId: '',\n          appUrl: '',\n        };\n\n  constructor(config?: Partial<WalletSDKConfig>) {\n    this.config = {\n      ...this.config,\n      ...(config || getConfigFromDataAttributes() || {}),\n    };\n\n    if (typeof window !== 'undefined') {\n      window.Grindery = {\n        ...this.config,\n      };\n    }\n\n    this.storage.setValue(\n      SdkStorageKeys.chainId,\n      this.storage.getValue(SdkStorageKeys.chainId) ||\n        this.config.chainId ||\n        CHAINS[0]\n    );\n    this.detectPairingToken();\n    this.provider = this.getWeb3Provider();\n    if (this.config.appId) {\n      this.provider.on(ProviderEvents.pair, this.handlePairing);\n    }\n  }\n\n  /**\n   * @summary Checks if the provider is connected to the server\n   * @returns {boolean} True if the provider is connected to the server.\n   *\n   * @example\n   * ```typescript\n   * const isConnected = window.Grindery.WalletSDK.isConnected();\n   * ```\n   */\n  public isConnected(): boolean {\n    return this.provider.isConnected();\n  }\n\n  /**\n   * @summary Checks if the provider is connected to the server and the Grindery Wallet\n   * @returns {boolean} True if the provider is connected to the server and the Grindery Wallet.\n   */\n  public isWalletConnected(): boolean {\n    return (\n      this.isConnected() &&\n      !!this.storage.getValue(SdkStorageKeys.pairingToken) &&\n      !this.storage.getValue(SdkStorageKeys.sessionId)\n    );\n  }\n\n  /**\n   * @summary Initiate connection to the Grindery Wallet\n   * @public\n   * @returns {Promise<string[]>} The array of ethereum addresses\n   * @since 0.1.0\n   */\n  public async connect(): Promise<string[]> {\n    return await this.provider.request({\n      method: ProviderMethodNames.eth_requestAccounts,\n    });\n  }\n\n  /**\n   * @summary Disconnects Grindery Wallet\n   * @public\n   * @returns {Promise<boolean>} True if wallet is disconnected\n   * @since 0.1.0\n   */\n  public async disconnect(): Promise<boolean> {\n    return await this.provider.request({\n      method: ProviderMethodNames.gws_disconnect,\n    });\n  }\n\n  /**\n   * @summary Sends a transaction request to the Grindery Wallet\n   * @public\n   * @since 0.1.0\n   * @param {object} params The transaction parameters\n   * @param {string} params.to The recipient address\n   * @param {string} [params.value] The amount to send in wei\n   * @param {string} [params.data] The data to send\n   * @returns {Promise<string>} Transaction hash string\n   */\n  public async sendTransaction(params: {\n    to: string;\n    value?: string;\n    data?: string;\n  }): Promise<string> {\n    return await this.provider.request<string>({\n      method: ProviderMethodNames.eth_sendTransaction,\n      params: [params],\n    });\n  }\n\n  /**\n   * @summary Sends a personal signature request to the Grindery Wallet\n   * @public\n   * @since 0.1.0\n   * @param {string} message The message to sign\n   * @returns {Promise<string>} Signature string\n   */\n  public async signMessage(message: string): Promise<string> {\n    return await this.provider.request<string>({\n      method: ProviderMethodNames.personal_sign,\n      params: [message, this.storage.getValue('address')],\n    });\n  }\n\n  /**\n   * @summary Requests the Grindery Wallet to switch the chain\n   * @public\n   * @since 0.3.0\n   * @param {string} chainId Chain id in CAIP-2 format\n   * @returns {Promise<null>} Returns `null` on success\n   */\n  public async switchChain(chainId: string): Promise<null> {\n    return await this.provider.request<null>({\n      method: ProviderMethodNames.wallet_switchEthereumChain,\n      params: { chainId: hexChainId(chainId) },\n    });\n  }\n\n  /**\n   * @summary Gets currently connected chain\n   * @public\n   * @since 0.3.0\n   * @returns {string} Returns chain id in CAIP-2 format\n   */\n  public getChain(): string {\n    return (\n      this.storage.getValue(SdkStorageKeys.chainId) ||\n      this.config.chainId ||\n      CHAINS[0]\n    );\n  }\n\n  /**\n   * @summary Exchange user ID to wallet address\n   * @public\n   * @since 0.4.0\n   * @param {string} userId User ID\n   * @returns {Promise<string>} Grindery Wallet address\n   */\n  public async getUserWalletAddress(\n    userId: string\n  ): Promise<RpcRequestResults.getUserWalletAddress> {\n    const rpc = new Rpc(this.config);\n    if (!this.config.appId) {\n      throw new Error('App ID is required');\n    }\n    return await rpc.sendRpcApiRequest<RpcRequestResults.getUserWalletAddress>(\n      RpcMethodNames.getUserWalletAddress,\n      { appId: this.config.appId, userId }\n    );\n  }\n\n  /**\n   * @summary Adds a listener to the event\n   * @public\n   * @param {ProviderEventName} event Event name\n   * @param {Function} callback Callback function\n   * @returns {EventEmitter} The instance of the class itself\n   */\n  public on(event: ProviderEventName, callback: Function) {\n    this.provider.on(event, callback);\n    return this;\n  }\n\n  /**\n   * @summary Removes a listener from the event\n   * @public\n   * @param {ProviderEventName} event Event name\n   * @param {Function} callback Callback function\n   * @returns {EventEmitter} The instance of the class itself\n   */\n  public removeListener(event: ProviderEventName, callback: Function) {\n    this.provider.removeListener(event, callback);\n    return this;\n  }\n\n  /**\n   * @summary Gets the Grindery user information\n   * @public\n   * @since 0.5.0\n   * @returns {Promise<User>} The Grindery user information\n   */\n  public async getUser(): Promise<User> {\n    if (!this.user) {\n      const api = new WalletAPI();\n      try {\n        this.user = await api.sendApiRequest<User>('gw_getMe');\n      } catch (e) {\n        throw new Error(\n          e instanceof Error ? e.message : 'Failed to fetch user information'\n        );\n      }\n    }\n    return this.user;\n  }\n\n  /**\n   * @summary Sets the application ID\n   * @public\n   * @since 0.5.1\n   * @param {string} appId The application ID\n   * @returns {void}\n   */\n  public setAppId(appId: string): void {\n    let appIdUpdated = false;\n    if (appId !== this.config.appId) {\n      appIdUpdated = true;\n    }\n    this.config.appId = appId;\n    if (typeof window !== 'undefined') {\n      window.Grindery = {\n        ...window.Grindery,\n        appId,\n      };\n    }\n    if (appIdUpdated) {\n      this.provider = this.getWeb3Provider();\n      this.provider.removeListener(ProviderEvents.pair, this.handlePairing);\n      setTimeout(() => {\n        this.provider.on(ProviderEvents.pair, this.handlePairing);\n      }, 0);\n    }\n  }\n\n  /**\n   * @summary Sets the SDK config\n   * @public\n   * @since 0.5.1\n   * @param {object} config The partial SDK config object\n   * @returns {void}\n   */\n  public setConfig(config: Partial<WalletSDKConfig>): void {\n    let appIdUpdated = false;\n    if (config.appId !== this.config.appId) {\n      appIdUpdated = true;\n    }\n    this.config = { ...this.config, ...config };\n    if (typeof window !== 'undefined') {\n      window.Grindery = {\n        ...window.Grindery,\n        ...this.config,\n      };\n    }\n    if (appIdUpdated) {\n      this.provider = this.getWeb3Provider();\n      this.provider.removeListener(ProviderEvents.pair, this.handlePairing);\n      setTimeout(() => {\n        this.provider.on(ProviderEvents.pair, this.handlePairing);\n      }, 0);\n    }\n  }\n\n  /**\n   * @summary Requests pairing by telegram login info\n   * @public\n   * @since 0.7.0\n   * @param {string} appSecret The application secret. Obtained in the Grindery bot by the dApp developer. Required. Must be kept secret.\n   * @param {TelegramLoginInfo} telegramLoginInfo The user's Telegram login info. Required.\n   * @param {string} [clientId] The client ID. Optional. Unique identifier of the client device.\n   */\n  public async requestPairingByTelegramLogin(\n    appSecret: string,\n    telegramLoginInfo: TelegramLoginInfo,\n    clientId?: string\n  ): Promise<void> {\n    try {\n      const rpc = new Rpc(this.config);\n      if (!this.config.appId) {\n        throw new Error('App ID is required');\n      }\n      const pairingRequest =\n        await rpc.sendRpcApiRequest<RpcRequestResults.requestPairingByTelegramLogin>(\n          RpcMethodNames.requestPairingByTelegramLogin,\n          {\n            appId: this.config.appId,\n            clientId:\n              clientId || this.storage.getValue(SdkStorageKeys.clientId),\n            appSecret,\n            telegramLoginInfo,\n          }\n        );\n      this.storage.setValue(\n        SdkStorageKeys.pairingToken,\n        pairingRequest.pairingToken\n      );\n      this.provider.restoreConnection();\n    } catch (e) {\n      throw new Error(\n        e instanceof Error\n          ? e.message\n          : 'Failed to request pairing by telegram login'\n      );\n    }\n  }\n\n  /**\n   * @summary Sends a request to the Grindery Wallet JSON-RPC API\n   * @public\n   * @since 0.7.0\n   * @param {string} method Wallet API method name\n   * @param {object} params Wallet API method params\n   * @returns {T} The result field of the JSON-RPC API request\n   */\n  public async sendWalletApiRequest<T>(\n    method: string,\n    params?: object\n  ): Promise<T> {\n    const api = new WalletAPI();\n    try {\n      return await api.sendApiRequest<T>(method, params);\n    } catch (e) {\n      throw new Error(\n        e instanceof Error ? e.message : 'Failed to send wallet API request'\n      );\n    }\n  }\n\n  /**\n   * @summary SdkStorage class instance\n   * @private\n   */\n  private storage: SdkStorage = new SdkStorage();\n\n  /**\n   * @summary The Grindery Wallet user\n   * @private\n   */\n  private user: User | null = null;\n\n  /**\n   * @summary Gets the Grindery Wallet ethereum provider\n   * @returns {Provider} The Grindery Wallet ethereum provider\n   */\n  private getWeb3Provider(): Provider {\n    return new Provider(this.config);\n  }\n\n  /**\n   * @summary Handles the pairing request, by opening the Grindery Wallet\n   * @private\n   * @param ProviderRequestPairingResult\n   * @returns {void}\n   */\n  private handlePairing({\n    config,\n    shortToken,\n    connectUrlBrowser,\n    miniAppPairingToken,\n  }: RpcRequestResults.requestPairing): void {\n    if (typeof window === 'undefined') {\n      alert('Please allow popups for this website and try again.');\n      return;\n    }\n    const redirectUrl =\n      connectUrlBrowser ||\n      `https://www.grindery.com/connect/wc?uri=${shortToken}`;\n    const miniAppUrl = miniAppPairingToken\n      ? `https://t.me/GrinderyConnectTestBot/confirm?startapp=${miniAppPairingToken.replaceAll(\n          '.',\n          '___'\n        )}`\n      : '';\n    if (miniAppUrl && config?.redirectMode === 'tg') {\n      window.open(miniAppUrl, '_blank');\n      return;\n    }\n    const connectPage = window.open(redirectUrl, '_blank');\n    if (!connectPage) {\n      alert('Please allow popups for this website and try again.');\n    }\n  }\n\n  private detectPairingToken(): void {\n    if (typeof window !== 'undefined') {\n      const urlParams = new URLSearchParams(window.location.search);\n      const token =\n        urlParams.get('_grinderyPairingToken') ||\n        urlParams.get('tgWebAppStartParam');\n      if (token) {\n        this.storage.setValue(SdkStorageKeys.pairingToken, token);\n        this.storage.setValue(SdkStorageKeys.sessionId, '');\n      }\n    }\n  }\n}\n","import { WalletSDKConfig } from '../classes/WalletSDK';\n\n/**\n * @summary Get the SDK config from the script tag data attributes\n * @returns {object} The SDK config object\n */\nexport const getConfigFromDataAttributes = (): Partial<WalletSDKConfig> => {\n  if (typeof document === 'undefined' || typeof window === 'undefined') {\n    return {};\n  }\n  let config: Partial<WalletSDKConfig> = {};\n  const attributesMap = {\n    'data-app-id': 'appId',\n    'data-wallet-api-url': 'walletApiUrl',\n    'data-pairing-api-url': 'pairingApiUrl',\n    'data-app-url': 'appUrl',\n    'data-redirect-mode': 'redirectMode',\n    'data-chain-id': 'chainId',\n  };\n  for (const [attribute, key] of Object.entries(attributesMap)) {\n    const elements = document.querySelectorAll(`[${attribute}]`);\n    for (let j = 0; j < elements.length; j++) {\n      const element = elements[j];\n      const value = element.getAttribute(attribute);\n      const src = element.getAttribute('src');\n      const isGrinderySrc = src && src.includes('grindery-wallet-sdk');\n      if (isGrinderySrc && value) {\n        config[key as keyof WalletSDKConfig] = value as string;\n      }\n    }\n  }\n  return config;\n};\n"],"names":["ProviderEvents","SdkStorageKeys","EventEmitter","this","events","Map","_proto","prototype","on","event","callback","has","set","get","push","removeListener","callbacks","filter","cb","emit","_len","arguments","length","data","Array","_key","console","log","forEach","apply","uuid","d","Math","random","toString","substr","vr","parseInt","providerInfo","name","rdns","icon","ProviderError","_Error","message","code","_this","call","_inheritsLoose","_wrapNativeSuper","Error","ProviderErrors","PairingFailed","Disconnected","UnsupportedMethod","Unauthorized","NoResult","NoAppId","UserRejected","ChainDisconnected","newProviderError","error","CHAINS","hexChainId","chainId","split","unhexChainId","LOCALSTORAGE_KEY","RpcMethodNames","SdkStorage","getValue","key","getSnapshot","setValue","value","snapshot","saveSnapshot","clear","clientId","JSON","parse","localStorage","getItem","setItem","stringify","storage","ProviderMethodNames","Rpc","config","sendAndWaitRpcRequest","_sendAndWaitRpcRequest","_asyncToGenerator","_regeneratorRuntime","mark","_callee","method","params","timeout","request","wrap","_context","prev","next","sendRpcRequest","sent","waitRpcRequest","requestToken","abrupt","stop","_x","_x2","_x3","_sendRpcRequest","_callee2","_context2","sendRpcApiRequest","sessionId","scope","_x4","_x5","_waitRpcRequest","_callee3","_context3","waitForRequestResult","_x6","_x7","_sendRpcApiRequest","_callee4","response","_context4","fetch","pairingApiUrl","headers","body","jsonrpc","id","json","result","t0","_x8","_x9","Provider","_window$Grindery","_EventEmitter","_this$methods","_this$config5","_ref10","_ref9","_ref8","_ref6","_ref5","_ref4","_ref3","isGrinderyWallet","rpc","switchChain","_ref2","_ref","chainCaip","includes","chainChanged","methods","eth_requestAccounts","pairResult","_this$config","_this$config2","_this$config3","_pairResult","appId","eth_accounts","waitForPairingResult","pairingToken","session","t1","requestPairing","redirectMode","redirectUrl","appUrl","connectUrl","connectUrlBrowser","shortToken","pair","miniAppPairingToken","t2","isArray","address","accountsChanged","eth_sendTransaction","personal_sign","_callee5","_context5","gws_disconnect","_callee6","_context6","disconnect","sessionToken","eth_chainId","_callee7","_","_this$config4","_context7","wallet_addEthereumChain","_callee8","_context8","wallet_switchEthereumChain","_callee9","_context9","injectProvider","listenForRequestProviderEvents","announceProvider","window","addEventListener","restoreConnection","_this$config6","_this$config7","connect","restorePairing","restoreSession","isConnected","_request","_callee10","_ref11","_this$methods$method","_this$methods2","_context10","sendAsync","_ref12","_this$methods$method2","_this$methods3","then","res","_restorePairing","_callee11","_pairResult$session","accounts","_context11","namespaces","map","account","_restoreSession","_callee12","_context12","_this2","ethereum","providers","p","dispatchEvent","CustomEvent","detail","Object","freeze","info","provider","_this3","WalletAPI","sendApiRequest","_sendApiRequest","customUrl","Grindery","WalletSDK","walletApiUrl","Authorization","ok","_window$Grindery2","_window$Grindery3","_window$Grindery4","_window$Grindery5","_window$Grindery6","location","origin","user","_extends","document","_i","_Object$entries","entries","_Object$entries$_i","attribute","elements","querySelectorAll","j","element","getAttribute","src","getConfigFromDataAttributes","detectPairingToken","getWeb3Provider","handlePairing","isWalletConnected","_connect","_disconnect","sendTransaction","_sendTransaction","signMessage","_signMessage","_switchChain","getChain","getUserWalletAddress","_getUserWalletAddress","userId","getUser","_getUser","api","setAppId","appIdUpdated","setTimeout","setConfig","requestPairingByTelegramLogin","_requestPairingByTelegramLogin","appSecret","telegramLoginInfo","sendWalletApiRequest","_sendWalletApiRequest","miniAppUrl","replaceAll","open","alert","urlParams","URLSearchParams","search","token","GrinderyWalletSDK"],"mappings":"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"}