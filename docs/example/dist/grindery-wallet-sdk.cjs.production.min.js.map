{"version":3,"file":"grindery-wallet-sdk.cjs.production.min.js","sources":["../src/provider/ProviderError.ts","../src/provider/GrinderyWalletProvider.ts","../src/provider/ProviderLocalStorage.ts","../src/provider/ProviderEventEmitter.ts","../src/sdk/GrinderyWalletSDK.ts","../src/index.ts"],"sourcesContent":["export class ProviderError extends Error {\n  name: string = 'GrinderyWalletProviderError';\n  code?: number;\n  data?: unknown;\n\n  constructor(message: string, code?: number, data?: unknown) {\n    super(message);\n    this.code = code;\n    this.data = data;\n  }\n}\n","import { ProviderError } from './ProviderError';\nimport { ProviderLocalStorage } from './ProviderLocalStorage';\nimport {\n  GrinderyRpcMethodName,\n  GrinderyRpcProviderRequestMethodName,\n  ProviderInterface,\n  ProviderMethods,\n  ProviderPairingResult,\n  ProviderRequestPairingResult,\n  ProviderRequestResult,\n  RequestArguments,\n  RequestArgumentsParams,\n} from './types';\n\nexport class GrinderyWalletProvider extends ProviderLocalStorage\n  implements ProviderInterface {\n  public readonly isGrinderyWallet: boolean = true;\n\n  constructor() {\n    super();\n    this.injectProvider();\n  }\n\n  public isConnected(): boolean {\n    return !!this.chainId;\n  }\n\n  public isWalletConnected(): boolean {\n    return this.isConnected() && !!this.getStorageValue('sessionId');\n  }\n\n  public isWalletConnectionPending(): boolean {\n    return this.isConnected() && !!this.getStorageValue('pairingToken');\n  }\n\n  public async request<T>({ method, params }: RequestArguments): Promise<T> {\n    if (method !== 'wallet_ping' && !this.chainId) {\n      throw new ProviderError('Disconnected', 4900);\n    }\n    if (!this.methods[method]) {\n      throw new ProviderError('Unsupported Method', 4200);\n    }\n\n    try {\n      if (this.methods[method].sessionRequired && !this.isWalletConnected()) {\n        throw new ProviderError('Unauthorized', 4900);\n      }\n      if (\n        this.methods[method].pairingTokenRequired &&\n        !this.isWalletConnectionPending()\n      ) {\n        throw new ProviderError('Unauthorized', 4900);\n      }\n      return (await this.methods[method].execute(params)) as T;\n    } catch (error) {\n      throw this.createProviderRpcError(error);\n    }\n  }\n\n  private appId: string = window.location.origin || 'localhost';\n  private chainId: string = 'eip155:137';\n\n  /* Avaialble provider `request` methods */\n  private methods: ProviderMethods = {\n    eth_requestAccounts: {\n      sessionRequired: false,\n      pairingTokenRequired: false,\n      execute: async (params?: RequestArgumentsParams): Promise<string[]> => {\n        if (this.isWalletConnected()) {\n          try {\n            return await this.request<string[]>({\n              method: 'eth_accounts',\n              params: params || [],\n            });\n          } catch (error) {\n            this.setStorageValue('sessionId', '');\n            // skip failed request and continue with pairing\n          }\n        }\n        if (this.isWalletConnectionPending()) {\n          try {\n            this.emit('restorePairing', {\n              connectUrl: this.getStorageValue('connectUrl'),\n              connectUrlBrowser: this.getStorageValue('connectUrlBrowser'),\n            });\n\n            const pairResult = await this.request<ProviderPairingResult>({\n              method: 'checkout_waitForPairingResult',\n              params: { pairingToken: this.getStorageValue('pairingToken') },\n            });\n\n            this.setStorageValue('sessionId', pairResult.sessionId);\n            this.setStorageValue('pairingToken', '');\n            this.setStorageValue('connectUrl', '');\n            this.setStorageValue('connectUrlBrowser', '');\n\n            if (!pairResult.sessionId) {\n              throw new ProviderError('Pairing failed', 4900);\n            }\n\n            return [];\n          } catch (error) {\n            this.setStorageValue('sessionId', '');\n            this.setStorageValue('pairingToken', '');\n            this.setStorageValue('connectUrl', '');\n            this.setStorageValue('connectUrlBrowser', '');\n            // skip failed request and continue with pairing\n          }\n        }\n        try {\n          const result = await this.request<ProviderRequestPairingResult>({\n            method: 'checkout_requestPairing',\n            params: { appId: this.appId },\n          });\n\n          if (!result.pairingToken || !result.connectUrl) {\n            throw new ProviderError('Pairing failed', 4900);\n          }\n\n          this.setStorageValue('pairingToken', result.pairingToken);\n          this.setStorageValue('connectUrl', result.connectUrl);\n          this.setStorageValue('connectUrlBrowser', result.connectUrlBrowser);\n          this.emit('pairing', {\n            connectUrl: result.connectUrl,\n            connectUrlBrowser: result.connectUrlBrowser,\n          });\n          const pairResult = await this.request<ProviderPairingResult>({\n            method: 'checkout_waitForPairingResult',\n            params: { pairingToken: result.pairingToken },\n          });\n\n          this.setStorageValue('sessionId', pairResult.sessionId);\n\n          if (!pairResult.sessionId) {\n            throw new ProviderError('Pairing failed', 4900);\n          }\n          return await this.sendGrinderyRpcApiRequest<string[]>(\n            'checkout_request',\n            {\n              sessionId: pairResult.sessionId,\n              scope: this.chainId,\n              request: {\n                method: 'eth_accounts',\n                params: [],\n              },\n            }\n          );\n        } catch (error) {\n          throw this.createProviderRpcError(error);\n        }\n      },\n    },\n    checkout_requestPairing: {\n      sessionRequired: false,\n      pairingTokenRequired: false,\n      execute: async (\n        params?: RequestArgumentsParams\n      ): Promise<ProviderRequestPairingResult> => {\n        return await this.sendGrinderyRpcApiRequest<\n          ProviderRequestPairingResult\n        >('checkout_requestPairing', params);\n      },\n    },\n    checkout_waitForPairingResult: {\n      sessionRequired: false,\n      pairingTokenRequired: true,\n      execute: async (\n        params?: RequestArgumentsParams\n      ): Promise<ProviderRequestPairingResult> => {\n        return await this.sendGrinderyRpcApiRequest<\n          ProviderRequestPairingResult\n        >('checkout_waitForPairingResult', params);\n      },\n    },\n    eth_accounts: {\n      sessionRequired: true,\n      pairingTokenRequired: false,\n      execute: async (\n        params?: RequestArgumentsParams\n      ): Promise<ProviderRequestResult> => {\n        return await this.sendGrinderyRpcProviderRequest(\n          'eth_accounts',\n          params ? (Array.isArray(params) ? params : [params]) : []\n        );\n      },\n    },\n    eth_sendTransaction: {\n      sessionRequired: true,\n      pairingTokenRequired: false,\n      execute: async (\n        params?: RequestArgumentsParams\n      ): Promise<ProviderRequestResult> => {\n        if (!this.isWalletConnected()) {\n          throw new ProviderError('Unauthorized', 4900);\n        }\n        return await this.sendGrinderyRpcProviderRequest(\n          'eth_sendTransaction',\n          params ? (Array.isArray(params) ? params : [params]) : []\n        );\n      },\n    },\n    personal_sign: {\n      sessionRequired: true,\n      pairingTokenRequired: false,\n      execute: async (\n        params?: Partial<RequestArgumentsParams>\n      ): Promise<{ requestToken: string }> => {\n        if (!this.isWalletConnected()) {\n          throw new ProviderError('Unauthorized', 4900);\n        }\n        return await this.sendGrinderyRpcProviderRequest(\n          'personal_sign',\n          params ? (Array.isArray(params) ? params : [params]) : []\n        );\n      },\n    },\n  };\n\n  private async sendGrinderyRpcProviderRequest(\n    method: GrinderyRpcProviderRequestMethodName,\n    params?: readonly unknown[]\n  ): Promise<ProviderRequestResult> {\n    if (!this.getStorageValue('sessionId')) {\n      throw new ProviderError('Unauthorized', 4900);\n    }\n    try {\n      return await this.sendGrinderyRpcApiRequest<ProviderRequestResult>(\n        'checkout_request',\n        {\n          sessionId: this.getStorageValue('sessionId'),\n          scope: this.chainId,\n          request: {\n            method,\n            params,\n          },\n        }\n      );\n    } catch (error) {\n      throw this.createProviderRpcError(error);\n    }\n  }\n\n  // waitForRequestResult\n\n  private async sendGrinderyRpcApiRequest<T>(\n    method: GrinderyRpcMethodName,\n    params?: RequestArgumentsParams\n  ): Promise<T> {\n    try {\n      const response = await fetch('https://walletconnect-api.grindery.com', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify({\n          jsonrpc: '2.0',\n          id: 1,\n          method,\n          params: params || [],\n        }),\n      });\n      const data = await response.json();\n      if (data.error) {\n        throw new ProviderError(data.error.message, data.error.code);\n      }\n      if (!data.result) {\n        throw new ProviderError('No result', 4900);\n      }\n      return data.result;\n    } catch (error) {\n      throw this.createProviderRpcError(error);\n    }\n  }\n\n  private createProviderRpcError(error: unknown): ProviderError {\n    let errorResponse: ProviderError;\n    if (error instanceof ProviderError) {\n      errorResponse = new ProviderError(error.message || 'Unknown error');\n      errorResponse.code = error.code || 4900;\n      errorResponse.data = error.data;\n    } else if (error instanceof Error) {\n      errorResponse = new ProviderError(error.message || 'Unknown error');\n      errorResponse.code = 4900;\n    } else {\n      errorResponse = new ProviderError('Unknown error');\n      errorResponse.code = 4900;\n    }\n    return errorResponse;\n  }\n\n  private injectProvider(): void {\n    if (!window.ethereum) {\n      window.ethereum = this;\n    } else {\n      if (\n        window.ethereum.providers &&\n        Array.isArray(window.ethereum.providers)\n      ) {\n        window.ethereum.providers.push(this);\n      } else {\n        window.ethereum.providers = [window.ethereum, this];\n      }\n    }\n\n    addEventListener('load', () => {\n      this.emit('connect', { chainId: this.chainId });\n    });\n  }\n}\n","import { ProviderEventEmitter } from './ProviderEventEmitter';\nimport { ProviderStorage, ProviderStorageKey } from './types';\n\nconst LOCALSTORAGE_KEY = 'GrinderyWalletProvider';\n\nexport class ProviderLocalStorage extends ProviderEventEmitter {\n  protected getStorageValue(key: ProviderStorageKey): string {\n    const value = this.getStorage()[key] || '';\n    return value;\n  }\n\n  protected setStorageValue(key: ProviderStorageKey, value: string): void {\n    const storage = this.getStorage();\n    storage[key] = value;\n    this.saveStorage(storage);\n  }\n\n  private getStorage(): ProviderStorage {\n    try {\n      return JSON.parse(\n        localStorage.getItem(LOCALSTORAGE_KEY) || '{}'\n      ) as ProviderStorage;\n    } catch (error) {\n      localStorage.setItem(LOCALSTORAGE_KEY, JSON.stringify({}));\n      throw new Error('Error parsing storage');\n    }\n  }\n\n  private saveStorage(storage: ProviderStorage): void {\n    localStorage.setItem(LOCALSTORAGE_KEY, JSON.stringify(storage));\n  }\n}\n","export class ProviderEventEmitter {\n  private events: Map<string, Array<Function>>;\n\n  constructor() {\n    this.events = new Map();\n  }\n\n  on(event: string, callback: Function) {\n    if (!this.events.has(event)) {\n      this.events.set(event, []);\n    }\n    this.events.get(event)!.push(callback);\n    return this;\n  }\n\n  removeListener(event: string, callback: Function) {\n    if (this.events.has(event)) {\n      const callbacks = this.events.get(event)!.filter(cb => cb !== callback);\n      this.events.set(event, callbacks);\n    }\n    return this;\n  }\n\n  protected emit(event: string, ...data: any[]) {\n    if (this.events.has(event)) {\n      console.log('[GrinderyWalletProvider] > Event:', event, data);\n      this.events.get(event)!.forEach(callback => {\n        callback(...data);\n      });\n    }\n    return this;\n  }\n}\n","import { GrinderyWalletProvider } from '../provider/GrinderyWalletProvider';\n\nexport class GrinderyWalletSDK {\n  public provider: GrinderyWalletProvider;\n\n  constructor() {\n    this.provider = this.getWeb3Provider();\n  }\n\n  private getWeb3Provider(): GrinderyWalletProvider {\n    let provider = window.ethereum?.providers?.find(\n      (provider: GrinderyWalletProvider | unknown) =>\n        provider instanceof GrinderyWalletProvider && provider.isGrinderyWallet\n    );\n    if (\n      !provider &&\n      window.ethereum instanceof GrinderyWalletProvider &&\n      window.ethereum.isGrinderyWallet\n    ) {\n      provider = window.ethereum;\n    }\n    if (!provider) {\n      provider = new GrinderyWalletProvider();\n    }\n    return provider;\n  }\n}\n","import { GrinderyWalletSDK } from './sdk/GrinderyWalletSDK';\n\ndeclare global {\n  interface Window {\n    Telegram?: any;\n    ethereum?: any;\n    Grindery?: {\n      WalletSDK?: GrinderyWalletSDK;\n    };\n  }\n}\n\nfunction init() {\n  if (\n    !window.Grindery?.WalletSDK ||\n    !(window.Grindery.WalletSDK instanceof GrinderyWalletSDK)\n  ) {\n    window.Grindery = {\n      ...(window.Grindery || {}),\n      WalletSDK: new GrinderyWalletSDK(),\n    };\n  }\n}\n\n// Initialize the SDK when the page is loaded\ninit();\n"],"names":["ProviderError","_Error","message","code","data","_this","call","_inheritsLoose","_wrapNativeSuper","Error","GrinderyWalletProvider","_ProviderLocalStorage","_execute6","_execute5","_execute4","_execute3","_execute2","_execute","window","location","origin","eth_requestAccounts","sessionRequired","pairingTokenRequired","execute","_asyncToGenerator","_regeneratorRuntime","mark","_callee","params","pairResult","result","_pairResult","wrap","_context","prev","next","isWalletConnected","request","method","abrupt","sent","t0","setStorageValue","isWalletConnectionPending","emit","connectUrl","getStorageValue","connectUrlBrowser","pairingToken","sessionId","t1","appId","sendGrinderyRpcApiRequest","scope","chainId","t2","createProviderRpcError","stop","_x","apply","arguments","checkout_requestPairing","_callee2","_context2","_x2","checkout_waitForPairingResult","_callee3","_context3","_x3","eth_accounts","_callee4","_context4","sendGrinderyRpcProviderRequest","Array","isArray","_x4","eth_sendTransaction","_callee5","_context5","_x5","personal_sign","_callee6","_context6","_x6","injectProvider","_proto","prototype","isConnected","this","_request","_callee7","_ref","_context7","methods","_x7","_sendGrinderyRpcProviderRequest","_callee8","_context8","_x8","_x9","_sendGrinderyRpcApiRequest","_callee9","response","_context9","fetch","headers","Content-Type","body","JSON","stringify","jsonrpc","id","json","error","_x10","_x11","errorResponse","ethereum","providers","push","addEventListener","_this2","_ProviderEventEmitter","ProviderLocalStorage","key","getStorage","value","storage","saveStorage","parse","localStorage","getItem","setItem","ProviderEventEmitter","events","Map","on","event","callback","has","set","get","removeListener","callbacks","filter","cb","_len","_key","console","log","forEach","GrinderyWalletSDK","provider","getWeb3Provider","_window$ethereum","find","isGrinderyWallet","_window$Grindery","Grindery","WalletSDK","_extends"],"mappings":"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"}